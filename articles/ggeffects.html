<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ggeffects">
<title>ggeffects: Marginal Means and Adjusted Predictions of Regression Models • ggeffects</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Roboto_Slab-0.4.9/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="ggeffects: Marginal Means and Adjusted Predictions of Regression Models">
<meta property="og:description" content="ggeffects">
<meta property="og:image" content="https://strengejacke.github.io/ggeffects/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-default navbar-expand-lg bg-light" data-bs-theme="default"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ggeffects</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.5.2.9</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-introductions">Introductions</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-introductions">
    <a class="dropdown-item" href="../articles/ggeffects.html">Adjusted Predictions of Regression Models</a>
    <a class="dropdown-item" href="../articles/introduction_effectsatvalues.html">Adjusted Predictions at Specific Values</a>
    <a class="dropdown-item" href="../articles/introduction_randomeffects.html">Adjusted Predictions for Random Effects Models</a>
    <a class="dropdown-item" href="../articles/practical_robustestimation.html">(Cluster) Robust Standard Errors</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-interpretation">Interpretation</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-interpretation">
    <a class="dropdown-item" href="../articles/introduction_comparisons_1.html">Contrasts and pairwise comparisons</a>
    <a class="dropdown-item" href="../articles/introduction_comparisons_2.html">Slopes, floodlight and spotlight analysis</a>
    <a class="dropdown-item" href="../articles/introduction_comparisons_3.html">Contrasts and pairwise comparisons for GLM</a>
    <a class="dropdown-item" href="../articles/introduction_comparisons_4.html">Using marginaleffects or emmeans for comparisons</a>
    <a class="dropdown-item" href="../articles/introduction_partial_residuals.html">Adding Partial Residuals to Effects Plots</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-plotting-and-printing">Plotting and Printing</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-plotting-and-printing">
    <a class="dropdown-item" href="../articles/introduction_plotmethod.html">Plotting Adjusted Predictions</a>
    <a class="dropdown-item" href="../articles/introduction_plotcustomize.html">Customize Plot Appearance</a>
    <a class="dropdown-item" href="../articles/introduction_print.html">Customize Table Appearance</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-case-studies">Case Studies</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-case-studies">
    <a class="dropdown-item" href="../articles/practical_logisticmixedmodel.html">Logistic Mixed Effects Model with Interaction Term</a>
    <a class="dropdown-item" href="../articles/practical_intersectionality.html">Intersectionality analysis using the MAIHDA framework</a>
    <a class="dropdown-item" href="../articles/practical_marginaleffects_pkg.html">Comparison of ggeffects and marginaleffects</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-technical-details">Technical Details</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-technical-details">
    <a class="dropdown-item" href="../articles/technical_differencepredictemmeans.html">Difference between marginalization methods</a>
    <a class="dropdown-item" href="../articles/technical_stata.html">Different Output between Stata and ggeffects</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/strengejacke/ggeffects/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>ggeffects: Marginal Means and Adjusted Predictions of Regression Models</h1>
                        <h4 data-toc-skip class="author">Daniel
Lüdecke</h4>
            
            <h4 data-toc-skip class="date">2024-04-19</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/strengejacke/ggeffects/blob/HEAD/vignettes/ggeffects.Rmd" class="external-link"><code>vignettes/ggeffects.Rmd</code></a></small>
      <div class="d-none name"><code>ggeffects.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="aims-of-the-ggeffects-package">Aims of the ggeffects-package<a class="anchor" aria-label="anchor" href="#aims-of-the-ggeffects-package"></a>
</h2>
<p>Results of regression models are typically presented as tables that
are easy to understand. For more complex models that include interaction
or transformed terms (e.g., splines or quadratic terms, log-transformed
outcomes, …), tables with regression coefficients are much more
difficult to interpret. In such cases, the visualization of <em>marginal
means</em> or <em>adjusted predictions</em> is far easier to understand
and allows to intuitively get the idea of how predictors and outcome are
associated, even for complex models.</p>
<p>There are three major goals that you can achieve with
<em>ggeffects</em>: computing marginal means and adjusted predictions,
testing these predictions for statistical significance, and creating
figures (plots). What you basically would need for your workflow is:
<code><a href="../reference/predict_response.html">predict_response()</a></code>, <code><a href="../reference/test_predictions.html">test_predictions()</a></code> and
<code><a href="../reference/plot.html">plot()</a></code>.</p>
<div class="section level3">
<h3 id="what-ggeffects-does">What ggeffects does<a class="anchor" aria-label="anchor" href="#what-ggeffects-does"></a>
</h3>
<p><strong>ggeffects</strong> computes marginal means and adjusted
predictions at the mean (MEM), at representative values (MER) or
averaged across predictors (so called <em>focal terms</em>) from
statistical models. The result is returned as data frame with consistent
structure, especially for further use with <a href="https://cran.r-project.org/package=ggplot2" class="external-link">ggplot</a>.</p>
<p>At least one focal term needs to be specified for which the effects
are computed. It is also possible to compute adjusted predictions for
focal terms, grouped by the levels of another model’s predictor. The
package also allows plotting adjusted predictions for two-, three- or
four-way-interactions, or for specific values of a focal term only.
Examples are shown below.</p>
</div>
<div class="section level3">
<h3 id="how-to-use-the-ggeffects-package-the-main-function">How to use the ggeffects-package: The main function<a class="anchor" aria-label="anchor" href="#how-to-use-the-ggeffects-package-the-main-function"></a>
</h3>
<p><code><a href="../reference/predict_response.html">predict_response()</a></code> is actually a wrapper around three
“workhorse” functions, <code><a href="../reference/ggpredict.html">ggpredict()</a></code>,
<code><a href="../reference/ggpredict.html">ggemmeans()</a></code> and <code><a href="../reference/ggpredict.html">ggaverage()</a></code>. Depending on the
value of the <code>margin</code> argument,
<code><a href="../reference/predict_response.html">predict_response()</a></code> calls one of those functions, with
different arguments. The <code>margin</code> argument indicates how to
marginalize over the <em>non-focal</em> predictors, i.e. those variables
that are <em>not</em> specified in <code>terms</code>.</p>
<p>It is important to know, which question you would like to answer. See
the following options for the <code>margin</code> argument and which
question is answered by each option:</p>
<ul>
<li>
<p><code>"mean_reference"</code> and <code>"mean_mode"</code>:
<code>"mean_reference"</code> calls <code><a href="../reference/ggpredict.html">ggpredict()</a></code>,
i.e. non-focal predictors are set to their mean (numeric variables),
reference level (factors), or “most common” value (mode) in case of
character vectors. <code>"mean_mode"</code> calls
<code>ggpredict(typical = c(numeric = "mean", factor = "mode"))</code>,
i.e. non-focal predictors are set to their mean (numeric variables) or
mode (factors, or “most common” value in case of character vectors).</p>
<p>Predictions based on <code>"mean_reference"</code> and
<code>"mean_mode"</code> represent a rather “theoretical” view on your
data, which does not necessarily exactly reflect the characteristics of
your sample. It helps answer the question, “What is the predicted value
of the response at meaningful values or levels of my focal terms for a
‘typical’ observation in my data?”, where ‘typical’ refers to certain
characteristics of the remaining predictors.</p>
</li>
<li>
<p><code>"marginalmeans"</code>: calls <code><a href="../reference/ggpredict.html">ggemmeans()</a></code>,
i.e. non-focal predictors are set to their mean (numeric variables) or
marginalized over the levels or “values” for factors and character
vectors. Marginalizing over the factor levels of non-focal terms
computes a kind of “weighted average” for the values at which these
terms are hold constant. Thus, non-focal categorical terms are
conditioned on “weighted averages” of their levels.</p>
<p><code>"marginalmeans"</code> comes closer to the sample, because it
takes all possible values and levels of your non-focal predictors into
account. It would answer thr question, “What is the predicted value of
the response at meaningful values or levels of my focal terms for an
‘average’ observation in my data?”. It refers to randomly picking a
subject of your sample and the result you get on average.</p>
</li>
<li>
<p><code>"empirical"</code> (or <code>"counterfactual"</code>):
calls <code><a href="../reference/ggpredict.html">ggaverage()</a></code>, i.e. non-focal predictors are
marginalized over the observations in your sample. The response is
predicted for each subject in the data and predicted values are then
averaged across all subjects, aggregated/grouped by the focal terms. In
particular, averaging is applied to <em>counterfactual predictions</em>
(Dickerman and Hernan 2020). There is a more detailed description in <a href="https://strengejacke.github.io/ggeffects/articles/technical_differencepredictemmeans.html">this
vignette</a>.</p>
<p><code>"empirical"</code>is probably the most “realistic” approach,
insofar as the results can also be transferred to other contexts. It
answers the question, “What is the predicted value of the response at
meaningful values or levels of my focal terms for the ‘average’
observation in the population?”. It does not only refer to the actual
data in your sample, but also “what would be if” we had more data, or if
we had data from a different population. This is where “counterfactual”
refers to.</p>
</li>
</ul>
<p>You can set a default-option for the <code>margin</code> argument via
<code><a href="https://rdrr.io/r/base/options.html" class="external-link">options()</a></code>,
e.g. <code>options(ggeffects_margin = "empirical")</code>, so you don’t
have to specify your “default” marginalization method each time you call
<code><a href="../reference/predict_response.html">predict_response()</a></code>. Use
<code>options(ggeffects_margin = NULL)</code> to remove that
setting.</p>
<p>The <code>condition</code> argument can be used to fix non-focal
terms to specific values.</p>
</div>
<div class="section level3">
<h3 id="short-technical-note">Short technical note<a class="anchor" aria-label="anchor" href="#short-technical-note"></a>
</h3>
<div class="section level4">
<h4 id="predicting-the-outcome">Predicting the outcome<a class="anchor" aria-label="anchor" href="#predicting-the-outcome"></a>
</h4>
<p>By default, <code><a href="../reference/predict_response.html">predict_response()</a></code> always returns predicted
values for the <em>response</em> of a model (or <em>response
distribution</em> for Bayesian models).</p>
</div>
<div class="section level4">
<h4 id="confidence-intervals">Confidence intervals<a class="anchor" aria-label="anchor" href="#confidence-intervals"></a>
</h4>
<p>Typically, <code><a href="../reference/predict_response.html">predict_response()</a></code> (or
<code><a href="../reference/ggpredict.html">ggpredict()</a></code>) returns confidence intervals based on the
standard errors as returned by the <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code>-function,
assuming normal distribution (<code>+/- 1.96 * SE</code>) resp. a
Student’s t-distribuion (if degrees of freedom are available). If
<code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> for a certain model object does <em>not</em>
return standard errors (for example, <em>merMod</em>-objects), these are
calculated manually, by following steps: matrix-multiply <code>X</code>
by the parameter vector <code>B</code> to get the predictions, then
extract the variance-covariance matrix <code>V</code> of the parameters
and compute <code>XVX'</code> to get the variance-covariance matrix of
the predictions. The square-root of the diagonal of this matrix
represent the standard errors of the predictions, which are then
multiplied by the critical test-statistic value (e.g., ~1.96 for normal
distribuion) for the confidence intervals.</p>
</div>
<div class="section level4">
<h4 id="mixed-models-and-prediction-intervals">Mixed models and prediction intervals<a class="anchor" aria-label="anchor" href="#mixed-models-and-prediction-intervals"></a>
</h4>
<p>For mixed models, if <code>type = "random"</code> or
<code>type = "zi_random"</code>, the uncertainty in the random effects
is accounted for when calculating the standard errors. Hence, in such
cases, the intervals may be considered as <em>prediction
intervals</em>.</p>
</div>
</div>
<div class="section level3">
<h3 id="consistent-data-frame-structure">Consistent data frame structure<a class="anchor" aria-label="anchor" href="#consistent-data-frame-structure"></a>
</h3>
<p>The returned data frames always have the same, consistent structure
and column names, so it’s easy to create ggplot-plots without the need
to re-write the arguments to be mapped in each ggplot-call.
<code>x</code> and <code>predicted</code> are the values for the x- and
y-axis. <code>conf.low</code> and <code>conf.high</code> could be used
as <code>ymin</code> and <code>ymax</code> aesthetics for ribbons to add
confidence bands to the plot. <code>group</code> can be used as
grouping-aesthetics, or for faceting.</p>
<p>If the original variable names are desired as column names, there is
an <code><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame()</a></code> method for objects of class
<code>ggeffects</code>, which has an <code>terms_to_colnames</code>
argument, to use the variable names as column names instead of the
standardized names <code>"x"</code> etc.</p>
<p>The examples shown here mostly use <strong>ggplot2</strong>-code for
the plots, however, there is also a <code><a href="../reference/plot.html">plot()</a></code>-method, which is
described in the vignette <a href="introduction_plotmethod.html">Plotting Adjusted
Predictions</a>.</p>
</div>
</div>
<div class="section level2">
<h2 id="adjusted-predictions-at-the-mean">Adjusted predictions at the mean<a class="anchor" aria-label="anchor" href="#adjusted-predictions-at-the-mean"></a>
</h2>
<p><code><a href="../reference/predict_response.html">predict_response()</a></code> computes predicted values for all
possible levels and values from model’s predictors that are defined as
<em>focal terms</em>. In the simplest case, a fitted model is passed as
first argument, and the focal term as second argument. Use the raw name
of the variable for the <code>terms</code>-argument only - you don’t
need to write things like <code>poly(term, 3)</code> or
<code>I(term^2)</code> for the <code>terms</code>-argument.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://strengejacke.github.io/ggeffects/">ggeffects</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">efc</span>, package <span class="op">=</span> <span class="st">"ggeffects"</span><span class="op">)</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">barthtot</span> <span class="op">~</span> <span class="va">c12hour</span> <span class="op">+</span> <span class="va">neg_c_7</span> <span class="op">+</span> <span class="va">c161sex</span> <span class="op">+</span> <span class="va">c172code</span>, data <span class="op">=</span> <span class="va">efc</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/predict_response.html">predict_response</a></span><span class="op">(</span><span class="va">fit</span>, terms <span class="op">=</span> <span class="st">"c12hour"</span><span class="op">)</span></span>
<span><span class="co">#&gt; # Predicted values of Total score BARTHEL INDEX</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; c12hour | Predicted |       95% CI</span></span>
<span><span class="co">#&gt; ----------------------------------</span></span>
<span><span class="co">#&gt;       0 |     75.44 | 73.25, 77.63</span></span>
<span><span class="co">#&gt;      20 |     70.38 | 68.56, 72.19</span></span>
<span><span class="co">#&gt;      45 |     64.05 | 62.39, 65.70</span></span>
<span><span class="co">#&gt;      65 |     58.98 | 57.15, 60.80</span></span>
<span><span class="co">#&gt;      85 |     53.91 | 51.71, 56.12</span></span>
<span><span class="co">#&gt;     105 |     48.85 | 46.14, 51.55</span></span>
<span><span class="co">#&gt;     125 |     43.78 | 40.51, 47.05</span></span>
<span><span class="co">#&gt;     170 |     32.38 | 27.73, 37.04</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Adjusted for:</span></span>
<span><span class="co">#&gt; *  neg_c_7 = 11.84</span></span>
<span><span class="co">#&gt; *  c161sex =  1.76</span></span>
<span><span class="co">#&gt; * c172code =  1.97</span></span></code></pre></div>
<p>As you can see, <code><a href="../reference/predict_response.html">predict_response()</a></code> (or their lower-level
functions <code><a href="../reference/ggpredict.html">ggpredict()</a></code>, <code><a href="../reference/ggpredict.html">ggeffect()</a></code>,
<code><a href="../reference/ggpredict.html">ggaverage()</a></code> or <code><a href="../reference/ggpredict.html">ggemmeans()</a></code>) has a nice
<code><a href="../reference/print.html">print()</a></code> method, which takes care of printing not too many
rows (but always an equally spaced range of values, including minimum
and maximum value of the term in question) and giving some extra
information. This is especially useful when predicted values are shown
depending on the levels of other terms (see below).</p>
<p>The output shows the predicted values for the response at each value
from the term <em>c12hour</em>. The data is already in shape for
ggplot:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mydf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_response.html">predict_response</a></span><span class="op">(</span><span class="va">fit</span>, terms <span class="op">=</span> <span class="st">"c12hour"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mydf</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">predicted</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggeffects_files/figure-html/unnamed-chunk-2-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="adjusted-predictions-at-the-mean-by-other-predictors-levels">Adjusted predictions at the mean by other predictors’ levels<a class="anchor" aria-label="anchor" href="#adjusted-predictions-at-the-mean-by-other-predictors-levels"></a>
</h2>
<p>The <code>terms</code> argument accepts up to four model terms, where
the second to fourth terms indicate grouping levels. This allows
predictions for the term in question at different levels or values for
other focal terms:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/predict_response.html">predict_response</a></span><span class="op">(</span><span class="va">fit</span>, terms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"c12hour"</span>, <span class="st">"c172code"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # Predicted values of Total score BARTHEL INDEX</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; c172code: low level of education</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; c12hour | Predicted |       95% CI</span></span>
<span><span class="co">#&gt; ----------------------------------</span></span>
<span><span class="co">#&gt;       0 |     74.75 | 71.26, 78.23</span></span>
<span><span class="co">#&gt;      30 |     67.15 | 64.03, 70.26</span></span>
<span><span class="co">#&gt;      55 |     60.81 | 57.77, 63.86</span></span>
<span><span class="co">#&gt;      85 |     53.22 | 49.95, 56.48</span></span>
<span><span class="co">#&gt;     115 |     45.62 | 41.86, 49.37</span></span>
<span><span class="co">#&gt;     170 |     31.69 | 26.59, 36.78</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; c172code: intermediate level of education</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; c12hour | Predicted |       95% CI</span></span>
<span><span class="co">#&gt; ----------------------------------</span></span>
<span><span class="co">#&gt;       0 |     75.46 | 73.28, 77.65</span></span>
<span><span class="co">#&gt;      30 |     67.87 | 66.16, 69.57</span></span>
<span><span class="co">#&gt;      55 |     61.53 | 59.82, 63.25</span></span>
<span><span class="co">#&gt;      85 |     53.93 | 51.72, 56.14</span></span>
<span><span class="co">#&gt;     115 |     46.34 | 43.35, 49.32</span></span>
<span><span class="co">#&gt;     170 |     32.40 | 27.74, 37.07</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; c172code: high level of education</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; c12hour | Predicted |       95% CI</span></span>
<span><span class="co">#&gt; ----------------------------------</span></span>
<span><span class="co">#&gt;       0 |     76.18 | 72.81, 79.55</span></span>
<span><span class="co">#&gt;      30 |     68.58 | 65.41, 71.76</span></span>
<span><span class="co">#&gt;      55 |     62.25 | 59.00, 65.50</span></span>
<span><span class="co">#&gt;      85 |     54.65 | 51.03, 58.27</span></span>
<span><span class="co">#&gt;     115 |     47.05 | 42.85, 51.26</span></span>
<span><span class="co">#&gt;     170 |     33.12 | 27.50, 38.74</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Adjusted for:</span></span>
<span><span class="co">#&gt; * neg_c_7 = 11.84</span></span>
<span><span class="co">#&gt; * c161sex =  1.76</span></span></code></pre></div>
<p>Creating a ggplot is pretty straightforward: the <code>colour</code>
aesthetics is mapped with the <code>group</code> column:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mydf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_response.html">predict_response</a></span><span class="op">(</span><span class="va">fit</span>, terms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"c12hour"</span>, <span class="st">"c172code"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mydf</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">predicted</span>, colour <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggeffects_files/figure-html/unnamed-chunk-4-1.png" width="672"></p>
<p>Another focal term would stratify the result and will create another
column named <code>facet</code>, which - as the name implies - might be
used to create a facted plot:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mydf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_response.html">predict_response</a></span><span class="op">(</span><span class="va">fit</span>, terms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"c12hour"</span>, <span class="st">"c172code"</span>, <span class="st">"c161sex"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># print a more compact table</span></span>
<span><span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">mydf</span>, collapse_tables <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; # Predicted values of Total score BARTHEL INDEX</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; c12hour |                        c172code |    c161sex | Predicted |       95% CI</span></span>
<span><span class="co">#&gt; ---------------------------------------------------------------------------------</span></span>
<span><span class="co">#&gt;       0 |          low level of education |   [1] Male |     73.95 | 69.35, 78.56</span></span>
<span><span class="co">#&gt;      45 |                                 |            |     62.56 | 58.22, 66.89</span></span>
<span><span class="co">#&gt;      85 |                                 |            |     52.42 | 47.89, 56.96</span></span>
<span><span class="co">#&gt;     170 |                                 |            |     30.89 | 24.84, 36.95</span></span>
<span><span class="co">#&gt;       0 |                                 | [2] Female |     75.00 | 71.40, 78.59</span></span>
<span><span class="co">#&gt;      45 |                                 |            |     63.60 | 60.45, 66.74</span></span>
<span><span class="co">#&gt;      85 |                                 |            |     53.46 | 50.12, 56.80</span></span>
<span><span class="co">#&gt;     170 |                                 |            |     31.93 | 26.82, 37.05</span></span>
<span><span class="co">#&gt;       0 | intermediate level of education |   [1] Male |     74.67 | 71.05, 78.29</span></span>
<span><span class="co">#&gt;      45 |                                 |            |     63.27 | 59.88, 66.67</span></span>
<span><span class="co">#&gt;      85 |                                 |            |     53.14 | 49.39, 56.89</span></span>
<span><span class="co">#&gt;     170 |                                 |            |     31.61 | 25.97, 37.25</span></span>
<span><span class="co">#&gt;       0 |                                 | [2] Female |     75.71 | 73.31, 78.12</span></span>
<span><span class="co">#&gt;      45 |                                 |            |     64.32 | 62.41, 66.22</span></span>
<span><span class="co">#&gt;      85 |                                 |            |     54.18 | 51.81, 56.56</span></span>
<span><span class="co">#&gt;     170 |                                 |            |     32.65 | 27.94, 37.37</span></span>
<span><span class="co">#&gt;       0 |         high level of education |   [1] Male |     75.39 | 71.03, 79.75</span></span>
<span><span class="co">#&gt;      45 |                                 |            |     63.99 | 59.72, 68.26</span></span>
<span><span class="co">#&gt;      85 |                                 |            |     53.86 | 49.22, 58.50</span></span>
<span><span class="co">#&gt;     170 |                                 |            |     32.33 | 25.94, 38.72</span></span>
<span><span class="co">#&gt;       0 |                                 | [2] Female |     76.43 | 72.88, 79.98</span></span>
<span><span class="co">#&gt;      45 |                                 |            |     65.03 | 61.67, 68.39</span></span>
<span><span class="co">#&gt;      85 |                                 |            |     54.90 | 51.15, 58.65</span></span>
<span><span class="co">#&gt;     170 |                                 |            |     33.37 | 27.69, 39.05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Adjusted for:</span></span>
<span><span class="co">#&gt; * neg_c_7 = 11.84</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mydf</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">predicted</span>, colour <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">facet</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggeffects_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
<p>Finally, a third differentation can be defined, creating another
column named <code>panel</code>. In such cases, you may create multiple
plots (for each value in <code>panel</code>). <strong>ggeffects</strong>
takes care of this when you use <code><a href="../reference/plot.html">plot()</a></code> and automatically
creates an integrated plot with all panels in one figure.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mydf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_response.html">predict_response</a></span><span class="op">(</span><span class="va">fit</span>, terms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"c12hour"</span>, <span class="st">"c172code"</span>, <span class="st">"c161sex"</span>, <span class="st">"neg_c_7"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mydf</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggeffects_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="adjusted-predictions-for-each-model-term">Adjusted predictions for each model term<a class="anchor" aria-label="anchor" href="#adjusted-predictions-for-each-model-term"></a>
</h2>
<p>If the <code>term</code> argument is either missing or
<code>NULL</code>, adjusted predictions for each model term are
calculated. The result is returned as a list, which can be plotted
manually (or using the <code><a href="../reference/plot.html">plot()</a></code> function).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mydf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_response.html">predict_response</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="va">mydf</span></span>
<span><span class="co">#&gt; $c12hour</span></span>
<span><span class="co">#&gt; # Predicted values of Total score BARTHEL INDEX</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; c12hour | Predicted |       95% CI</span></span>
<span><span class="co">#&gt; ----------------------------------</span></span>
<span><span class="co">#&gt;       0 |     75.44 | 73.25, 77.63</span></span>
<span><span class="co">#&gt;      20 |     70.38 | 68.56, 72.19</span></span>
<span><span class="co">#&gt;      45 |     64.05 | 62.39, 65.70</span></span>
<span><span class="co">#&gt;      65 |     58.98 | 57.15, 60.80</span></span>
<span><span class="co">#&gt;      85 |     53.91 | 51.71, 56.12</span></span>
<span><span class="co">#&gt;     105 |     48.85 | 46.14, 51.55</span></span>
<span><span class="co">#&gt;     125 |     43.78 | 40.51, 47.05</span></span>
<span><span class="co">#&gt;     170 |     32.38 | 27.73, 37.04</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Adjusted for:</span></span>
<span><span class="co">#&gt; *  neg_c_7 = 11.84</span></span>
<span><span class="co">#&gt; *  c161sex =  1.76</span></span>
<span><span class="co">#&gt; * c172code =  1.97</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $neg_c_7</span></span>
<span><span class="co">#&gt; # Predicted values of Total score BARTHEL INDEX</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; neg_c_7 | Predicted |       95% CI</span></span>
<span><span class="co">#&gt; ----------------------------------</span></span>
<span><span class="co">#&gt;       6 |     78.17 | 75.10, 81.23</span></span>
<span><span class="co">#&gt;       8 |     73.57 | 71.20, 75.94</span></span>
<span><span class="co">#&gt;      12 |     64.38 | 62.73, 66.04</span></span>
<span><span class="co">#&gt;      14 |     59.79 | 57.88, 61.70</span></span>
<span><span class="co">#&gt;      16 |     55.19 | 52.72, 57.67</span></span>
<span><span class="co">#&gt;      20 |     46.00 | 42.04, 49.97</span></span>
<span><span class="co">#&gt;      22 |     41.41 | 36.63, 46.20</span></span>
<span><span class="co">#&gt;      28 |     27.63 | 20.30, 34.96</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Adjusted for:</span></span>
<span><span class="co">#&gt; *  c12hour = 42.20</span></span>
<span><span class="co">#&gt; *  c161sex =  1.76</span></span>
<span><span class="co">#&gt; * c172code =  1.97</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $c161sex</span></span>
<span><span class="co">#&gt; # Predicted values of Total score BARTHEL INDEX</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; c161sex | Predicted |       95% CI</span></span>
<span><span class="co">#&gt; ----------------------------------</span></span>
<span><span class="co">#&gt;       1 |     63.96 | 60.57, 67.35</span></span>
<span><span class="co">#&gt;       2 |     65.00 | 63.11, 66.90</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Adjusted for:</span></span>
<span><span class="co">#&gt; *  c12hour = 42.20</span></span>
<span><span class="co">#&gt; *  neg_c_7 = 11.84</span></span>
<span><span class="co">#&gt; * c172code =  1.97</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $c172code</span></span>
<span><span class="co">#&gt; # Predicted values of Total score BARTHEL INDEX</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; c172code | Predicted |       95% CI</span></span>
<span><span class="co">#&gt; -----------------------------------</span></span>
<span><span class="co">#&gt;        1 |     64.06 | 61.01, 67.11</span></span>
<span><span class="co">#&gt;        2 |     64.78 | 63.12, 66.43</span></span>
<span><span class="co">#&gt;        3 |     65.49 | 62.31, 68.68</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Adjusted for:</span></span>
<span><span class="co">#&gt; * c12hour = 42.20</span></span>
<span><span class="co">#&gt; * neg_c_7 = 11.84</span></span>
<span><span class="co">#&gt; * c161sex =  1.76</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "ggalleffects" "list"        </span></span>
<span><span class="co">#&gt; attr(,"model.name")</span></span>
<span><span class="co">#&gt; [1] "fit"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="two-way-three-way--and-four-way-interactions">Two-Way, Three-Way- and Four-Way-Interactions<a class="anchor" aria-label="anchor" href="#two-way-three-way--and-four-way-interactions"></a>
</h2>
<p>To plot the adjusted predictions of interaction terms, simply specify
these terms in the <code>terms</code> argument.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">efc</span>, package <span class="op">=</span> <span class="st">"ggeffects"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># make categorical</span></span>
<span><span class="va">efc</span><span class="op">$</span><span class="va">c161sex</span> <span class="op">&lt;-</span> <span class="fu">datawizard</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/datawizard/reference/to_factor.html" class="external-link">to_factor</a></span><span class="op">(</span><span class="va">efc</span><span class="op">$</span><span class="va">c161sex</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># fit model with interaction</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">neg_c_7</span> <span class="op">~</span> <span class="va">c12hour</span> <span class="op">+</span> <span class="va">barthtot</span> <span class="op">*</span> <span class="va">c161sex</span>, data <span class="op">=</span> <span class="va">efc</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># select only levels 30, 50 and 70 from continuous variable Barthel-Index</span></span>
<span><span class="va">mydf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_response.html">predict_response</a></span><span class="op">(</span><span class="va">fit</span>, terms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"barthtot [30,50,70]"</span>, <span class="st">"c161sex"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mydf</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">predicted</span>, colour <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggeffects_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
<p>Since the <code>terms</code> argument accepts up to four focal terms,
you can also compute adjusted predictions for a 3-way-interaction or
4-way-interaction. To plot the adjusted predictions of three interaction
terms, just like before, specify all three terms in the
<code>terms</code> argument.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># fit model with 3-way-interaction</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">neg_c_7</span> <span class="op">~</span> <span class="va">c12hour</span> <span class="op">*</span> <span class="va">barthtot</span> <span class="op">*</span> <span class="va">c161sex</span>, data <span class="op">=</span> <span class="va">efc</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># select only levels 30, 50 and 70 from continuous variable Barthel-Index</span></span>
<span><span class="va">mydf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_response.html">predict_response</a></span><span class="op">(</span><span class="va">fit</span>, terms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"c12hour"</span>, <span class="st">"barthtot [30,50,70]"</span>, <span class="st">"c161sex"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mydf</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">predicted</span>, colour <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">facet</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggeffects_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
<p>4-way-interactions are rather confusing to print and plot. When
plotting, multiple plots (for each level of the fourth interaction term)
are plotted for the remaining three interaction terms. This can easily
be done using the <a href="https://strengejacke.github.io/ggeffects/articles/introduction_plotmethod.html"><code>plot()</code>-method</a>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># fit model with 4-way-interaction</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">neg_c_7</span> <span class="op">~</span> <span class="va">c12hour</span> <span class="op">*</span> <span class="va">barthtot</span> <span class="op">*</span> <span class="va">c161sex</span> <span class="op">*</span> <span class="va">c172code</span>, data <span class="op">=</span> <span class="va">efc</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># adjusted predictions for all 4 interaction terms</span></span>
<span><span class="va">pr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_response.html">predict_response</a></span><span class="op">(</span><span class="va">fit</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"c12hour"</span>, <span class="st">"barthtot"</span>, <span class="st">"c161sex"</span>, <span class="st">"c172code"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># use plot() method, easier than own ggplot-code from scratch</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">pr</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggeffects_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="polynomial-terms-and-splines">Polynomial terms and splines<a class="anchor" aria-label="anchor" href="#polynomial-terms-and-splines"></a>
</h2>
<p><code><a href="../reference/predict_response.html">predict_response()</a></code> also works for models with polynomial
terms or splines. Following code reproduces the plot from
<code><a href="https://rdrr.io/r/splines/bs.html" class="external-link">?splines::bs</a></code>:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">splines</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">women</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/splines/bs.html" class="external-link">bs</a></span><span class="op">(</span><span class="va">height</span>, df <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">women</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_response.html">predict_response</a></span><span class="op">(</span><span class="va">fm1</span>, <span class="st">"height"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">predicted</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggeffects_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="survival-models">Survival models<a class="anchor" aria-label="anchor" href="#survival-models"></a>
</h2>
<p><code><a href="../reference/predict_response.html">predict_response()</a></code> also supports
<code>coxph</code>-models from the <strong>survival</strong>-package and
is able to either plot risk-scores (the default), probabilities of
survival (<code>type = "survival"</code>) or cumulative hazards
(<code>type = "cumulative_hazard"</code>).</p>
<p>Since probabilities of survival and cumulative hazards are changing
across time, the time-variable is automatically used as x-axis in such
cases, so the <code>terms</code> argument only needs up to
<strong>two</strong> variables for <code>type = "survival"</code> or
<code>type = "cumulative_hazard"</code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"lung2"</span><span class="op">)</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">coxph</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">ph.ecog</span>, data <span class="op">=</span> <span class="va">lung2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># predicted risk-scores</span></span>
<span><span class="fu"><a href="../reference/predict_response.html">predict_response</a></span><span class="op">(</span><span class="va">m</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sex"</span>, <span class="st">"ph.ecog"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # Predicted risk scores</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ph.ecog: good</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; sex    | Predicted |     95% CI</span></span>
<span><span class="co">#&gt; -------------------------------</span></span>
<span><span class="co">#&gt; male   |      1.00 | 1.00, 1.00</span></span>
<span><span class="co">#&gt; female |      0.58 | 0.42, 0.81</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ph.ecog: ok</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; sex    | Predicted |     95% CI</span></span>
<span><span class="co">#&gt; -------------------------------</span></span>
<span><span class="co">#&gt; male   |      1.51 | 1.02, 2.23</span></span>
<span><span class="co">#&gt; female |      0.87 | 0.53, 1.43</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ph.ecog: limited</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; sex    | Predicted |     95% CI</span></span>
<span><span class="co">#&gt; -------------------------------</span></span>
<span><span class="co">#&gt; male   |      2.47 | 1.58, 3.86</span></span>
<span><span class="co">#&gt; female |      1.43 | 0.83, 2.45</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Adjusted for:</span></span>
<span><span class="co">#&gt; * age = 62.42</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># probability of survival</span></span>
<span><span class="fu"><a href="../reference/predict_response.html">predict_response</a></span><span class="op">(</span><span class="va">m</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sex"</span>, <span class="st">"ph.ecog"</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"survival"</span><span class="op">)</span></span>
<span><span class="co">#&gt; # Probability of Survival</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; sex: male</span></span>
<span><span class="co">#&gt; ph.ecog: good</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time | Predicted |     95% CI</span></span>
<span><span class="co">#&gt; -----------------------------</span></span>
<span><span class="co">#&gt;    1 |      1.00 | 1.00, 1.00</span></span>
<span><span class="co">#&gt;  180 |      0.78 | 0.69, 0.87</span></span>
<span><span class="co">#&gt;  276 |      0.65 | 0.54, 0.78</span></span>
<span><span class="co">#&gt; 1022 |      0.09 | 0.03, 0.26</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; sex: male</span></span>
<span><span class="co">#&gt; ph.ecog: ok</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time | Predicted |     95% CI</span></span>
<span><span class="co">#&gt; -----------------------------</span></span>
<span><span class="co">#&gt;    1 |      1.00 | 1.00, 1.00</span></span>
<span><span class="co">#&gt;  180 |      0.69 | 0.60, 0.79</span></span>
<span><span class="co">#&gt;  276 |      0.52 | 0.42, 0.64</span></span>
<span><span class="co">#&gt; 1022 |      0.02 | 0.01, 0.11</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; sex: male</span></span>
<span><span class="co">#&gt; ph.ecog: limited</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time | Predicted |     95% CI</span></span>
<span><span class="co">#&gt; -----------------------------</span></span>
<span><span class="co">#&gt;    1 |      1.00 | 1.00, 1.00</span></span>
<span><span class="co">#&gt;  180 |      0.54 | 0.42, 0.70</span></span>
<span><span class="co">#&gt;  276 |      0.34 | 0.22, 0.52</span></span>
<span><span class="co">#&gt; 1022 |      0.00 | 0.00, 0.04</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; sex: female</span></span>
<span><span class="co">#&gt; ph.ecog: good</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time | Predicted |     95% CI</span></span>
<span><span class="co">#&gt; -----------------------------</span></span>
<span><span class="co">#&gt;    1 |      1.00 | 1.00, 1.00</span></span>
<span><span class="co">#&gt;  180 |      0.87 | 0.80, 0.93</span></span>
<span><span class="co">#&gt;  276 |      0.78 | 0.68, 0.88</span></span>
<span><span class="co">#&gt; 1022 |      0.24 | 0.11, 0.51</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; sex: female</span></span>
<span><span class="co">#&gt; ph.ecog: ok</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time | Predicted |     95% CI</span></span>
<span><span class="co">#&gt; -----------------------------</span></span>
<span><span class="co">#&gt;    1 |      1.00 | 1.00, 1.00</span></span>
<span><span class="co">#&gt;  180 |      0.80 | 0.73, 0.88</span></span>
<span><span class="co">#&gt;  276 |      0.68 | 0.59, 0.79</span></span>
<span><span class="co">#&gt; 1022 |      0.12 | 0.04, 0.31</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; sex: female</span></span>
<span><span class="co">#&gt; ph.ecog: limited</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time | Predicted |     95% CI</span></span>
<span><span class="co">#&gt; -----------------------------</span></span>
<span><span class="co">#&gt;    1 |      1.00 | 1.00, 1.00</span></span>
<span><span class="co">#&gt;  180 |      0.70 | 0.59, 0.83</span></span>
<span><span class="co">#&gt;  276 |      0.53 | 0.40, 0.71</span></span>
<span><span class="co">#&gt; 1022 |      0.03 | 0.00, 0.19</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Adjusted for:</span></span>
<span><span class="co">#&gt; * age = 62.42</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="labelling-the-data">Labelling the data<a class="anchor" aria-label="anchor" href="#labelling-the-data"></a>
</h2>
<p><strong>ggeffects</strong> makes use of the <a href="https://cran.r-project.org/package=sjlabelled" class="external-link">sjlabelled-package</a>
and supports <a href="https://cran.r-project.org/package=sjlabelled/vignettes/intro_sjlabelled.html" class="external-link">labelled
data</a>. If the data from the fitted models is labelled, the value and
variable label attributes are usually copied to the model frame stored
in the model object. <strong>ggeffects</strong> provides various
<em>getter</em>-functions to access these labels, which are returned as
character vector and can be used in ggplot’s <code>lab()</code>- or
<code>scale_*()</code>-functions.</p>
<ul>
<li>
<code><a href="../reference/get_title.html">get_title()</a></code> - a generic title for the plot, based on
the model family, like “predicted values” or “predicted
probabilities”</li>
<li>
<code><a href="../reference/get_title.html">get_x_title()</a></code> - the variable label of the first model
term in <code>terms</code>.</li>
<li>
<code><a href="../reference/get_title.html">get_y_title()</a></code> - the variable label of the
response.</li>
<li>
<code><a href="../reference/get_title.html">get_legend_title()</a></code> - the variable label of the second
model term in <code>terms</code>.</li>
<li>
<code><a href="../reference/get_title.html">get_x_labels()</a></code> - value labels of the first model term
in <code>terms</code>.</li>
<li>
<code><a href="../reference/get_title.html">get_legend_labels()</a></code> - value labels of the second model
term in <code>terms</code>.</li>
</ul>
<p>The data frame returned by <code><a href="../reference/predict_response.html">predict_response()</a></code> must be
used as argument to one of the above function calls.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_title.html">get_x_title</a></span><span class="op">(</span><span class="va">mydf</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "average number of hours of care per week"</span></span>
<span><span class="fu"><a href="../reference/get_title.html">get_y_title</a></span><span class="op">(</span><span class="va">mydf</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Negative impact with 7 items"</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mydf</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">predicted</span>, colour <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">facet</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fu"><a href="../reference/get_title.html">get_x_title</a></span><span class="op">(</span><span class="va">mydf</span><span class="op">)</span>,</span>
<span>    y <span class="op">=</span> <span class="fu"><a href="../reference/get_title.html">get_y_title</a></span><span class="op">(</span><span class="va">mydf</span><span class="op">)</span>,</span>
<span>    colour <span class="op">=</span> <span class="fu"><a href="../reference/get_title.html">get_legend_title</a></span><span class="op">(</span><span class="va">mydf</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="ggeffects_files/figure-html/unnamed-chunk-14-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Dickerman BA, Hernan, MA. Counterfactual prediction is not only for
causal inference. Eur J Epidemiol 35, 615–617 (2020).</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/strengejacke" class="external-link">Daniel Lüdecke</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.9000.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
