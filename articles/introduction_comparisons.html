<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ggeffects">
<title>Slopes, Contrasts and Pairwise Comparisons" • ggeffects</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.5/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.5/font.css" rel="stylesheet">
<link href="../deps/Roboto_Slab-0.4.5/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Slopes, Contrasts and Pairwise Comparisons">
<meta property="og:description" content="ggeffects">
<meta property="og:image" content="https://strengejacke.github.io/ggeffects/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-default navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ggeffects</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.5.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-introductions">Introductions</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-introductions">
    <a class="dropdown-item" href="../articles/ggeffects.html">Adjusted Predictions of Regression Models</a>
    <a class="dropdown-item" href="../articles/introduction_marginal_effects.html">Definition of Marginal Effects</a>
    <a class="dropdown-item" href="../articles/introduction_effectsatvalues.html">Adjusted Predictions at Specific Values</a>
    <a class="dropdown-item" href="../articles/introduction_randomeffects.html">Adjusted Predictions for Random Effects Models</a>
    <a class="dropdown-item" href="../articles/introduction_comparisons.html">Slopes, contrasts, and pairwise comparisons</a>
    <a class="dropdown-item" href="../articles/introduction_partial_residuals.html">Adding Partial Residuals to Effects Plots</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-plotting">Plotting</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-plotting">
    <a class="dropdown-item" href="../articles/introduction_plotmethod.html">Plotting Adjusted Predictions</a>
    <a class="dropdown-item" href="../articles/introduction_plotcustomize.html">Customize Plot Appearance</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-practical-examples">Practical Examples</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-practical-examples">
    <a class="dropdown-item" href="../articles/practical_logisticmixedmodel.html">Logistic Mixed Effects Model with Interaction Term</a>
    <a class="dropdown-item" href="../articles/practical_robustestimation.html">(Cluster) Robust Standard Errors</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-technical-details">Technical Details</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-technical-details">
    <a class="dropdown-item" href="../articles/technical_differencepredictemmeans.html">Difference between ggpredict() and ggemmeans()</a>
    <a class="dropdown-item" href="../articles/technical_stata.html">Different Output between Stata and ggeffects</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/strengejacke/ggeffects/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Slopes, Contrasts and Pairwise Comparisons"</h1>
                        <h4 data-toc-skip class="author">Daniel
Lüdecke</h4>
            
            <h4 data-toc-skip class="date">2023-02-19</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/strengejacke/ggeffects/blob/HEAD/vignettes/introduction_comparisons.Rmd" class="external-link"><code>vignettes/introduction_comparisons.Rmd</code></a></small>
      <div class="d-none name"><code>introduction_comparisons.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="hypothesis-testing-for-categorical-predictors">Hypothesis testing for categorical predictors<a class="anchor" aria-label="anchor" href="#hypothesis-testing-for-categorical-predictors"></a>
</h2>
<p>A reason to compute adjusted predictions (or estimated marginal
means) is to help understanding the relationship between predictors and
outcome of a regression model. In particular for more complex models,
for example, complex interaction terms, it is often easier to understand
the associations when looking at adjusted predictions instead of the raw
table of regression coefficients.</p>
<p>The next step, which often follows this, is to see if there are
statistically significant differences. These could be, for example,
differences between groups, i.e. between the levels of categorical
predictors or whether trends differ significantly from each other.</p>
<p>The <em>ggeffects</em> package provides a function,
<code><a href="../reference/hypothesis_test.html">hypothesis_test()</a></code>, which does exactly this: testing
differences of adjusted predictions for statistical significance. This
is usually called <em>contrasts</em> or <em>(pairwise) comparisons</em>.
This vignette shows some examples how to use the
<code><a href="../reference/hypothesis_test.html">hypothesis_test()</a></code> function and how to test wheter
differences in predictions are statistically significant.</p>
<div class="section level3">
<h3 id="within-episode-do-levels-differ">Within <code>episode</code>, do levels differ?<a class="anchor" aria-label="anchor" href="#within-episode-do-levels-differ"></a>
</h3>
<p>We start with a toy example, where we have a linear model with two
categorical predictors. No interaction is involved for now.</p>
<p>We display a simple table of regression coefficients, created with
<code><a href="https://easystats.github.io/parameters/reference/model_parameters.html" class="external-link">model_parameters()</a></code> from the <em>parameters</em>
package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://strengejacke.github.io/ggeffects/">ggeffects</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/parameters/" class="external-link">parameters</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  outcome <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,</span>
<span>  group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"treatment"</span>, <span class="st">"control"</span><span class="op">)</span>, <span class="va">n</span>, <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  episode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="va">n</span>, <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  sex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"female"</span>, <span class="st">"male"</span><span class="op">)</span>, <span class="va">n</span>, <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.4</span>, <span class="fl">.6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">model1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">outcome</span> <span class="op">~</span> <span class="va">group</span> <span class="op">+</span> <span class="va">episode</span>, data <span class="op">=</span> <span class="va">d</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://easystats.github.io/parameters/reference/model_parameters.html" class="external-link">model_parameters</a></span><span class="op">(</span><span class="va">model1</span><span class="op">)</span></span>
<span><span class="co">#&gt; Parameter         | Coefficient |   SE |        95% CI | t(196) |     p</span></span>
<span><span class="co">#&gt; -----------------------------------------------------------------------</span></span>
<span><span class="co">#&gt; (Intercept)       |       -0.08 | 0.13 | [-0.33, 0.18] |  -0.60 | 0.552</span></span>
<span><span class="co">#&gt; group [treatment] |       -0.17 | 0.13 | [-0.44, 0.09] |  -1.30 | 0.197</span></span>
<span><span class="co">#&gt; episode [2]       |        0.36 | 0.16 | [ 0.03, 0.68] |   2.18 | 0.031</span></span>
<span><span class="co">#&gt; episode [3]       |        0.10 | 0.16 | [-0.22, 0.42] |   0.62 | 0.538</span></span></code></pre></div>
<div class="section level4">
<h4 id="predictions">Predictions<a class="anchor" aria-label="anchor" href="#predictions"></a>
</h4>
<p>Let us look at the adjusted predictions.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mydf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggpredict.html">ggpredict</a></span><span class="op">(</span><span class="va">model1</span>, <span class="st">"episode"</span><span class="op">)</span></span>
<span><span class="va">mydf</span></span>
<span><span class="co">#&gt; # Predicted values of outcome</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; episode | Predicted |        95% CI</span></span>
<span><span class="co">#&gt; -----------------------------------</span></span>
<span><span class="co">#&gt; 1       |     -0.08 | [-0.33, 0.17]</span></span>
<span><span class="co">#&gt; 2       |      0.28 | [ 0.03, 0.54]</span></span>
<span><span class="co">#&gt; 3       |      0.02 | [-0.24, 0.28]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Adjusted for:</span></span>
<span><span class="co">#&gt; * group = control</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mydf</span><span class="op">)</span></span></code></pre></div>
<p><img src="introduction_comparisons_files/figure-html/unnamed-chunk-2-1.png" width="672"></p>
<p>We now see that, for instance, the predicted <em>outcome</em> when
<code>espisode = 2</code> is 0.28.</p>
</div>
<div class="section level4">
<h4 id="pairwise-comparisons">Pairwise comparisons<a class="anchor" aria-label="anchor" href="#pairwise-comparisons"></a>
</h4>
<p>We could now ask whether the predicted outcome for
<code>episode = 1</code> is significantly different from the predicted
outcome at <code>episode = 2</code>.</p>
<p><img src="introduction_comparisons_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
<p>To do this, we use the <code><a href="../reference/hypothesis_test.html">hypothesis_test()</a></code> function. This
function, like <code><a href="../reference/ggpredict.html">ggpredict()</a></code>, accepts the model object as
first argument, followed by the <em>focal predictors</em> of interest,
i.e. the variables of the model for which contrasts or pairwise
comparisons should be calculated.</p>
<p>By default, when all focal terms are categorical, a pairwise
comparison is performed. You can specify other hypothesis tests as well,
using the <code>test</code> argument (which defaults to
<code>"pairwise"</code>, see <code><a href="../reference/hypothesis_test.html">?hypothesis_test</a></code>). For now, we
go on with the simpler example of contrasts or pairwise comparisons.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hypothesis_test.html">hypothesis_test</a></span><span class="op">(</span><span class="va">model1</span>, <span class="st">"episode"</span><span class="op">)</span> <span class="co"># argument `test` defaults to "pairwise"</span></span>
<span><span class="co">#&gt; # Pairwise comparisons</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; episode | Contrast |         95% CI |     p</span></span>
<span><span class="co">#&gt; -------------------------------------------</span></span>
<span><span class="co">#&gt; 1-2     |    -0.36 | [-0.68, -0.04] | 0.030</span></span>
<span><span class="co">#&gt; 1-3     |    -0.10 | [-0.41,  0.22] | 0.538</span></span>
<span><span class="co">#&gt; 2-3     |     0.26 | [-0.06,  0.58] | 0.110</span></span></code></pre></div>
<p>For our quantity of interest, the contrast between episode 1-2, we
see the value -0.36, which is exactly the difference between the
predicted outcome for <code>episode = 1</code> (-0.08) and
<code>episode = 2</code> (0.28). The related p-value is 0.03, indicating
that the difference between the predicted values of our outcome at these
two levels of the factor <em>episode</em> is indeed statistically
significant.</p>
<p>In this simple example, the contrasts of both
<code>episode = 2</code> and <code>episode = 3</code> to
<code>episode = 1</code> equals the coefficients of the regression table
above (same applies to the p-values), where the coefficients refer to
the difference between the related parameter of <code>episode</code> and
its reference level, <code>episode = 1</code>.</p>
<p>To avoid specifying all arguments used in a call to
<code><a href="../reference/ggpredict.html">ggpredict()</a></code> again, we can also pass the objects returned by
<code><a href="../reference/ggpredict.html">ggpredict()</a></code> directly into
<code><a href="../reference/hypothesis_test.html">hypothesis_test()</a></code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggpredict.html">ggpredict</a></span><span class="op">(</span><span class="va">model1</span>, <span class="st">"episode"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/hypothesis_test.html">hypothesis_test</a></span><span class="op">(</span><span class="va">pred</span><span class="op">)</span></span>
<span><span class="co">#&gt; # Pairwise comparisons</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; episode | Contrast |         95% CI |     p</span></span>
<span><span class="co">#&gt; -------------------------------------------</span></span>
<span><span class="co">#&gt; 1-2     |    -0.36 | [-0.68, -0.04] | 0.030</span></span>
<span><span class="co">#&gt; 1-3     |    -0.10 | [-0.41,  0.22] | 0.538</span></span>
<span><span class="co">#&gt; 2-3     |     0.26 | [-0.06,  0.58] | 0.110</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="does-same-level-of-episode-differ-between-groups">Does same level of episode differ between groups?<a class="anchor" aria-label="anchor" href="#does-same-level-of-episode-differ-between-groups"></a>
</h3>
<p>The next example includes a pairwise comparison of an interaction
between two categorical predictors.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">outcome</span> <span class="op">~</span> <span class="va">group</span> <span class="op">*</span> <span class="va">episode</span>, data <span class="op">=</span> <span class="va">d</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://easystats.github.io/parameters/reference/model_parameters.html" class="external-link">model_parameters</a></span><span class="op">(</span><span class="va">model2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Parameter                       | Coefficient |   SE |        95% CI | t(194) |     p</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------------------------</span></span>
<span><span class="co">#&gt; (Intercept)                     |        0.03 | 0.15 | [-0.27, 0.33] |   0.18 | 0.853</span></span>
<span><span class="co">#&gt; group [treatment]               |       -0.42 | 0.23 | [-0.88, 0.04] |  -1.80 | 0.074</span></span>
<span><span class="co">#&gt; episode [2]                     |        0.20 | 0.22 | [-0.23, 0.63] |   0.94 | 0.350</span></span>
<span><span class="co">#&gt; episode [3]                     |       -0.07 | 0.22 | [-0.51, 0.37] |  -0.32 | 0.750</span></span>
<span><span class="co">#&gt; group [treatment] × episode [2] |        0.36 | 0.33 | [-0.29, 1.02] |   1.09 | 0.277</span></span>
<span><span class="co">#&gt; group [treatment] × episode [3] |        0.37 | 0.32 | [-0.27, 1.00] |   1.14 | 0.254</span></span></code></pre></div>
<div class="section level4">
<h4 id="predictions-1">Predictions<a class="anchor" aria-label="anchor" href="#predictions-1"></a>
</h4>
<p>First, we look at the predicted values of <em>outcome</em> for all
combinations of the involved interaction term.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mydf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggpredict.html">ggpredict</a></span><span class="op">(</span><span class="va">model2</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"episode"</span>, <span class="st">"group"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mydf</span></span>
<span><span class="co">#&gt; # Predicted values of outcome</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # group = control</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; episode | Predicted |        95% CI</span></span>
<span><span class="co">#&gt; -----------------------------------</span></span>
<span><span class="co">#&gt; 1       |      0.03 | [-0.27, 0.33]</span></span>
<span><span class="co">#&gt; 2       |      0.23 | [-0.07, 0.54]</span></span>
<span><span class="co">#&gt; 3       |     -0.04 | [-0.36, 0.28]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # group = treatment</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; episode | Predicted |         95% CI</span></span>
<span><span class="co">#&gt; ------------------------------------</span></span>
<span><span class="co">#&gt; 1       |     -0.39 | [-0.74, -0.04]</span></span>
<span><span class="co">#&gt; 2       |      0.18 | [-0.18,  0.53]</span></span>
<span><span class="co">#&gt; 3       |     -0.09 | [-0.39,  0.20]</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mydf</span><span class="op">)</span></span></code></pre></div>
<p><img src="introduction_comparisons_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
</div>
<div class="section level4">
<h4 id="pairwise-comparisons-1">Pairwise comparisons<a class="anchor" aria-label="anchor" href="#pairwise-comparisons-1"></a>
</h4>
<p>We could now ask whether the predicted outcome for
<code>episode = 2</code> is significantly different depending on the
level of <code>group</code>? In other words, do the groups
<code>treatment</code> and <code>control</code> differ when
<code>episode = 2</code>?</p>
<p><img src="introduction_comparisons_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
<p>Again, to answer this question, we calculate all pairwise
comparisons, i.e. the comparison (or test for differences) between all
combinations of our <em>focal predictors</em>. The focal predictors
we’re interested here are our two variables used for the
interaction.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># we want "episode = 2-2" and "group = control-treatment"</span></span>
<span><span class="fu"><a href="../reference/hypothesis_test.html">hypothesis_test</a></span><span class="op">(</span><span class="va">model2</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"episode"</span>, <span class="st">"group"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # Pairwise comparisons</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; episode |               group | Contrast |         95% CI |     p</span></span>
<span><span class="co">#&gt; -----------------------------------------------------------------</span></span>
<span><span class="co">#&gt; 1-2     |     control-control |    -0.20 | [-0.63,  0.22] | 0.349</span></span>
<span><span class="co">#&gt; 1-3     |     control-control |     0.07 | [-0.37,  0.51] | 0.750</span></span>
<span><span class="co">#&gt; 1-1     |   control-treatment |     0.42 | [-0.04,  0.87] | 0.072</span></span>
<span><span class="co">#&gt; 1-2     |   control-treatment |    -0.15 | [-0.61,  0.31] | 0.529</span></span>
<span><span class="co">#&gt; 1-3     |   control-treatment |     0.12 | [-0.30,  0.54] | 0.572</span></span>
<span><span class="co">#&gt; 2-3     |     control-control |     0.27 | [-0.17,  0.72] | 0.223</span></span>
<span><span class="co">#&gt; 2-1     |   control-treatment |     0.62 | [ 0.16,  1.08] | 0.008</span></span>
<span><span class="co">#&gt; 2-2     |   control-treatment |     0.06 | [-0.41,  0.52] | 0.816</span></span>
<span><span class="co">#&gt; 2-3     |   control-treatment |     0.32 | [-0.10,  0.75] | 0.135</span></span>
<span><span class="co">#&gt; 3-1     |   control-treatment |     0.35 | [-0.12,  0.82] | 0.148</span></span>
<span><span class="co">#&gt; 3-2     |   control-treatment |    -0.22 | [-0.69,  0.26] | 0.366</span></span>
<span><span class="co">#&gt; 3-3     |   control-treatment |     0.05 | [-0.39,  0.49] | 0.821</span></span>
<span><span class="co">#&gt; 1-2     | treatment-treatment |    -0.57 | [-1.06, -0.07] | 0.025</span></span>
<span><span class="co">#&gt; 1-3     | treatment-treatment |    -0.30 | [-0.75,  0.16] | 0.202</span></span>
<span><span class="co">#&gt; 2-3     | treatment-treatment |     0.27 | [-0.19,  0.73] | 0.252</span></span></code></pre></div>
<p>For our quantity of interest, the contrast between groups
<code>treatment</code> and <code>control</code> when
<code>episode = 2</code> is 0.06. We find this comparison in row 8 of
the above output.</p>
<p>As we can see, <code><a href="../reference/hypothesis_test.html">hypothesis_test()</a></code> returns pairwise
comparisons of all possible combinations of factor levels from our focal
variables. If we’re only interested in a very specific comparison, we
could directly formulate this comparison as <code>test</code>. To
achieve this, we first need to create an overview of the adjusted
predictions, which we get from <code><a href="../reference/ggpredict.html">ggpredict()</a></code> or
<code>hypothesis_test(test = NULL)</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># adjusted predictions, formatted table</span></span>
<span><span class="fu"><a href="../reference/ggpredict.html">ggpredict</a></span><span class="op">(</span><span class="va">model2</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"episode"</span>, <span class="st">"group"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # Predicted values of outcome</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # group = control</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; episode | Predicted |        95% CI</span></span>
<span><span class="co">#&gt; -----------------------------------</span></span>
<span><span class="co">#&gt; 1       |      0.03 | [-0.27, 0.33]</span></span>
<span><span class="co">#&gt; 2       |      0.23 | [-0.07, 0.54]</span></span>
<span><span class="co">#&gt; 3       |     -0.04 | [-0.36, 0.28]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # group = treatment</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; episode | Predicted |         95% CI</span></span>
<span><span class="co">#&gt; ------------------------------------</span></span>
<span><span class="co">#&gt; 1       |     -0.39 | [-0.74, -0.04]</span></span>
<span><span class="co">#&gt; 2       |      0.18 | [-0.18,  0.53]</span></span>
<span><span class="co">#&gt; 3       |     -0.09 | [-0.39,  0.20]</span></span>
<span></span>
<span><span class="co"># adjusted predictions, compact table</span></span>
<span><span class="fu"><a href="../reference/hypothesis_test.html">hypothesis_test</a></span><span class="op">(</span><span class="va">model2</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"episode"</span>, <span class="st">"group"</span><span class="op">)</span>, test <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="co">#&gt; episode |     group | Predicted |         95% CI |     p</span></span>
<span><span class="co">#&gt; --------------------------------------------------------</span></span>
<span><span class="co">#&gt; 1       |   control |      0.03 | [-0.27,  0.33] | 0.853</span></span>
<span><span class="co">#&gt; 2       |   control |      0.23 | [-0.07,  0.54] | 0.137</span></span>
<span><span class="co">#&gt; 3       |   control |     -0.04 | [-0.36,  0.28] | 0.792</span></span>
<span><span class="co">#&gt; 1       | treatment |     -0.39 | [-0.74, -0.04] | 0.027</span></span>
<span><span class="co">#&gt; 2       | treatment |      0.18 | [-0.18,  0.53] | 0.327</span></span>
<span><span class="co">#&gt; 3       | treatment |     -0.09 | [-0.39,  0.20] | 0.539</span></span></code></pre></div>
<p>In the above output, each row is considered as one coefficient of
interest. Our groups we want to include in our comparison are rows two
(<code>group = control</code> and <code>episode = 2</code>) and five
(<code>group = treatment</code> and <code>episode = 2</code>), so our
“quantities of interest” are <code>b2</code> and <code>b5</code>. Our
null hypothesis we want to test is whether both predictions are equal,
i.e. <code>test = "b2 = b5"</code>. We can now calculate the desired
comparison directly:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># compute specific contrast directly</span></span>
<span><span class="fu"><a href="../reference/hypothesis_test.html">hypothesis_test</a></span><span class="op">(</span><span class="va">model2</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"episode"</span>, <span class="st">"group"</span><span class="op">)</span>, test <span class="op">=</span> <span class="st">"b2 = b5"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Hypothesis | Contrast |        95% CI |     p</span></span>
<span><span class="co">#&gt; ---------------------------------------------</span></span>
<span><span class="co">#&gt; b2=b5      |     0.06 | [-0.41, 0.52] | 0.816</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Tested hypothesis: episode[2],group[control] = episode[2],group[treatment]</span></span></code></pre></div>
<p>The reason for this specific way of specifying the <code>test</code>
argument is because <code><a href="../reference/hypothesis_test.html">hypothesis_test()</a></code> is a small,
convenient wrapper around <code>predictions()</code> and
<code>slopes()</code> of the great <a href="https://vincentarelbundock.github.io/marginaleffects/" class="external-link"><em>marginaleffects</em></a>
package. Thus, <code>test</code> is just passed to the <a href="https://vincentarelbundock.github.io/marginaleffects/articles/hypothesis.html" class="external-link"><code>hypothesis</code>
argument</a> of those functions.</p>
</div>
</div>
<div class="section level3">
<h3 id="do-different-episode-levels-differ-between-groups">Do different episode levels differ between groups?<a class="anchor" aria-label="anchor" href="#do-different-episode-levels-differ-between-groups"></a>
</h3>
<p>We can repeat the steps shown above to test any combination of group
levels for differences.</p>
<div class="section level4">
<h4 id="pairwise-comparisons-2">Pairwise comparisons<a class="anchor" aria-label="anchor" href="#pairwise-comparisons-2"></a>
</h4>
<p>For instance, we could now ask whether the predicted outcome for
<code>episode = 1</code> in the <code>treatment</code> group is
significantly different from the predicted outcome for
<code>episode = 3</code> in the <code>control</code> group.</p>
<p><img src="introduction_comparisons_files/figure-html/unnamed-chunk-12-1.png" width="672"></p>
<p>The contrast we are interested in is between <code>episode = 1</code>
in the <code>treatment</code> group and <code>episode = 3</code> in the
<code>control</code> group. These are the predicted values in rows three
and four (c.f. above table of predicted values), thus we
<code>test</code> whether <code>"b4 = b3"</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hypothesis_test.html">hypothesis_test</a></span><span class="op">(</span><span class="va">model2</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"episode"</span>, <span class="st">"group"</span><span class="op">)</span>, test <span class="op">=</span> <span class="st">"b4 = b3"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Hypothesis | Contrast |        95% CI |     p</span></span>
<span><span class="co">#&gt; ---------------------------------------------</span></span>
<span><span class="co">#&gt; b4=b3      |    -0.35 | [-0.82, 0.12] | 0.148</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Tested hypothesis: episode[1],group[treatment] = episode[3],group[control]</span></span></code></pre></div>
<p>Another way to produce this pairwise comparison, we can reduce the
table of predicted values by providing <a href="https://strengejacke.github.io/ggeffects/articles/introduction_effectsatvalues.html">specific
values or levels</a> in the <code>terms</code> argument:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggpredict.html">ggpredict</a></span><span class="op">(</span><span class="va">model2</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"episode [1,3]"</span>, <span class="st">"group"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # Predicted values of outcome</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # group = control</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; episode | Predicted |        95% CI</span></span>
<span><span class="co">#&gt; -----------------------------------</span></span>
<span><span class="co">#&gt; 1       |      0.03 | [-0.27, 0.33]</span></span>
<span><span class="co">#&gt; 3       |     -0.04 | [-0.36, 0.28]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # group = treatment</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; episode | Predicted |         95% CI</span></span>
<span><span class="co">#&gt; ------------------------------------</span></span>
<span><span class="co">#&gt; 1       |     -0.39 | [-0.74, -0.04]</span></span>
<span><span class="co">#&gt; 3       |     -0.09 | [-0.39,  0.20]</span></span></code></pre></div>
<p><code>episode = 1</code> in the <code>treatment</code> group and
<code>episode = 3</code> in the <code>control</code> group refer now to
rows two and three, thus we also can obtain the desired comparison this
way:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggpredict.html">ggpredict</a></span><span class="op">(</span><span class="va">model2</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"episode [1,3]"</span>, <span class="st">"group"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/hypothesis_test.html">hypothesis_test</a></span><span class="op">(</span><span class="va">pred</span>, test <span class="op">=</span> <span class="st">"b3 = b2"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Hypothesis | Contrast |        95% CI |     p</span></span>
<span><span class="co">#&gt; ---------------------------------------------</span></span>
<span><span class="co">#&gt; b3=b2      |    -0.35 | [-0.82, 0.12] | 0.148</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Tested hypothesis: episode[1],group[treatment] = episode[3],group[control]</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="does-difference-between-two-levels-of-episode-in-the-control-group-differ-from-difference-of-same-two-levels-in-the-treatment-group">Does difference between two levels of episode in the control group
differ from difference of same two levels in the treatment group?<a class="anchor" aria-label="anchor" href="#does-difference-between-two-levels-of-episode-in-the-control-group-differ-from-difference-of-same-two-levels-in-the-treatment-group"></a>
</h3>
<p>The <code>test</code> argument also allows us to compare
difference-in-differences. For example, is the difference between two
episode levels in one group significantly different from the difference
of the same two episode levels in the other group?</p>
<p><img src="introduction_comparisons_files/figure-html/unnamed-chunk-16-1.png" width="672"></p>
<p>As a reminder, we look at the table of predictions again:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hypothesis_test.html">hypothesis_test</a></span><span class="op">(</span><span class="va">model2</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"episode"</span>, <span class="st">"group"</span><span class="op">)</span>, test <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="co">#&gt; episode |     group | Predicted |         95% CI |     p</span></span>
<span><span class="co">#&gt; --------------------------------------------------------</span></span>
<span><span class="co">#&gt; 1       |   control |      0.03 | [-0.27,  0.33] | 0.853</span></span>
<span><span class="co">#&gt; 2       |   control |      0.23 | [-0.07,  0.54] | 0.137</span></span>
<span><span class="co">#&gt; 3       |   control |     -0.04 | [-0.36,  0.28] | 0.792</span></span>
<span><span class="co">#&gt; 1       | treatment |     -0.39 | [-0.74, -0.04] | 0.027</span></span>
<span><span class="co">#&gt; 2       | treatment |      0.18 | [-0.18,  0.53] | 0.327</span></span>
<span><span class="co">#&gt; 3       | treatment |     -0.09 | [-0.39,  0.20] | 0.539</span></span></code></pre></div>
<p>The first difference of episode levels 1 and 2 in the control group
refer to rows one and two in the above table (<code>b1</code> and
<code>b2</code>). The difference for the same episode levels in the
treatment group refer to the difference between rows four and five
(<code>b4</code> and <code>b5</code>). Thus, we have
<code>b1 - b2</code> and <code>b4 - b5</code>, and our null hypothesis
is that these two differences are equal:
<code>test = "(b1 - b2) = (b4 - b5)"</code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hypothesis_test.html">hypothesis_test</a></span><span class="op">(</span><span class="va">model2</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"episode"</span>, <span class="st">"group"</span><span class="op">)</span>, test <span class="op">=</span> <span class="st">"(b1 - b2) = (b4 - b5)"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Hypothesis      | Contrast |        95% CI |     p</span></span>
<span><span class="co">#&gt; --------------------------------------------------</span></span>
<span><span class="co">#&gt; (b1-b2)=(b4-b5) |     0.36 | [-0.29, 1.02] | 0.276</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Tested hypothesis: (episode[1],group[control] - episode[2],group[control]) = (episode[1],group[treatment] - episode[2],group[treatment])</span></span></code></pre></div>
<p>Let’s replicate this step-by-step:</p>
<ol style="list-style-type: decimal">
<li>Predicted value of <em>outcome</em> for <code>episode = 1</code> in
the control group is 0.03.</li>
<li>Predicted value of <em>outcome</em> for <code>episode = 2</code> in
the control group is 0.23.</li>
<li>The first difference is -0.2</li>
<li>Predicted value of <em>outcome</em> for <code>episode = 1</code> in
the treatment group is -0.39.</li>
<li>Predicted value of <em>outcome</em> for <code>episode = 2</code> in
the treatment group is 0.18.</li>
<li>The second difference is -0.57</li>
<li>Our quantity of interest is the difference between these two
differences, which is 0.36. This difference is not statistically
significant (p = 0.276).</li>
</ol>
</div>
</div>
<div class="section level2">
<h2 id="hypothesis-testing-for-slopes-of-numeric-predictors">Hypothesis testing for slopes of numeric predictors<a class="anchor" aria-label="anchor" href="#hypothesis-testing-for-slopes-of-numeric-predictors"></a>
</h2>
<p>For numeric focal terms, it is possible to conduct hypothesis testing
for slopes, or the <em>linear trend</em> of these focal terms.</p>
<p>Let’s start with a simple example again.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Sepal.Width</span> <span class="op">~</span> <span class="va">Sepal.Length</span> <span class="op">+</span> <span class="va">Species</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://easystats.github.io/parameters/reference/model_parameters.html" class="external-link">model_parameters</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span><span class="co">#&gt; Parameter            | Coefficient |   SE |         95% CI | t(146) |      p</span></span>
<span><span class="co">#&gt; ----------------------------------------------------------------------------</span></span>
<span><span class="co">#&gt; (Intercept)          |        1.68 | 0.24 | [ 1.21,  2.14] |   7.12 | &lt; .001</span></span>
<span><span class="co">#&gt; Sepal Length         |        0.35 | 0.05 | [ 0.26,  0.44] |   7.56 | &lt; .001</span></span>
<span><span class="co">#&gt; Species [versicolor] |       -0.98 | 0.07 | [-1.13, -0.84] | -13.64 | &lt; .001</span></span>
<span><span class="co">#&gt; Species [virginica]  |       -1.01 | 0.09 | [-1.19, -0.82] | -10.80 | &lt; .001</span></span></code></pre></div>
<p>We can already see from the coefficient table that the slope for
<code>Sepal.Length</code> is 0.35. We will thus find the same increase
for the predicted values in our outcome when our focal variable,
<code>Sepal.Length</code> increases by one unit.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggpredict.html">ggpredict</a></span><span class="op">(</span><span class="va">m</span>, <span class="st">"Sepal.Length [4,5,6,7]"</span><span class="op">)</span></span>
<span><span class="co">#&gt; # Predicted values of Sepal.Width</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sepal.Length | Predicted |       95% CI</span></span>
<span><span class="co">#&gt; ---------------------------------------</span></span>
<span><span class="co">#&gt;            4 |      3.08 | [2.95, 3.20]</span></span>
<span><span class="co">#&gt;            5 |      3.43 | [3.35, 3.51]</span></span>
<span><span class="co">#&gt;            6 |      3.78 | [3.66, 3.90]</span></span>
<span><span class="co">#&gt;            7 |      4.13 | [3.93, 4.32]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Adjusted for:</span></span>
<span><span class="co">#&gt; * Species = setosa</span></span></code></pre></div>
<p>Consequently, in this case of a simple slope, we see the same result
for the hypothesis test for the linar trend of
<code>Sepal.Length</code>:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hypothesis_test.html">hypothesis_test</a></span><span class="op">(</span><span class="va">m</span>, <span class="st">"Sepal.Length"</span><span class="op">)</span></span>
<span><span class="co">#&gt; # Linear trend for Sepal.Length</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Slope |       95% CI |      p</span></span>
<span><span class="co">#&gt; -----------------------------</span></span>
<span><span class="co">#&gt; 0.35  | [0.26, 0.44] | &lt; .001</span></span></code></pre></div>
<div class="section level3">
<h3 id="is-the-linear-trend-of-sepal-length-significant-for-the-different-levels-of-species">Is the linear trend of <code>Sepal.Length</code> significant for the
different levels of <code>Species</code>?<a class="anchor" aria-label="anchor" href="#is-the-linear-trend-of-sepal-length-significant-for-the-different-levels-of-species"></a>
</h3>
<p>Let’s move on to a more complex example with an interaction between a
numeric and categorical variable.</p>
<div class="section level4">
<h4 id="predictions-2">Predictions<a class="anchor" aria-label="anchor" href="#predictions-2"></a>
</h4>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Sepal.Width</span> <span class="op">~</span> <span class="va">Sepal.Length</span> <span class="op">*</span> <span class="va">Species</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></span>
<span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggpredict.html">ggpredict</a></span><span class="op">(</span><span class="va">m</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sepal.Length"</span>, <span class="st">"Species"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">pred</span><span class="op">)</span></span></code></pre></div>
<p><img src="introduction_comparisons_files/figure-html/unnamed-chunk-22-1.png" width="672"></p>
</div>
<div class="section level4">
<h4 id="slopes-by-group">Slopes by group<a class="anchor" aria-label="anchor" href="#slopes-by-group"></a>
</h4>
<p>We can see that the slope of <code>Sepal.Length</code> is different
within each group of <code>Species</code>.</p>
<p><img src="introduction_comparisons_files/figure-html/unnamed-chunk-23-1.png" width="672"></p>
<p>Since we don’t want to do pairwise comparisons, we set
<code>test = NULL</code>. In this case, when interaction terms are
included, the linear trend (<em>slope</em>) for our numeric focal
predictor, <code>Sepal.Length</code>, is tested for each level of
<code>Species</code>.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hypothesis_test.html">hypothesis_test</a></span><span class="op">(</span><span class="va">m</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sepal.Length"</span>, <span class="st">"Species"</span><span class="op">)</span>, test <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="co">#&gt; # Linear trend for Sepal.Length</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Species    | Slope |       95% CI |      p</span></span>
<span><span class="co">#&gt; ------------------------------------------</span></span>
<span><span class="co">#&gt; setosa     |  0.80 | [0.58, 1.01] | &lt; .001</span></span>
<span><span class="co">#&gt; versicolor |  0.32 | [0.17, 0.47] | &lt; .001</span></span>
<span><span class="co">#&gt; virginica  |  0.23 | [0.11, 0.35] | &lt; .001</span></span></code></pre></div>
<p>As we can see, each of the three slopes is significant, i.e. we have
“significant” linear trends.</p>
</div>
<div class="section level4">
<h4 id="pairwise-comparisons-3">Pairwise comparisons<a class="anchor" aria-label="anchor" href="#pairwise-comparisons-3"></a>
</h4>
<p>Next question could be whether or not linear trends differ
significantly between each other, i.e. we test differences in slopes,
which is a pairwise comparison between slopes. To do this, we use the
default for <code>test</code>, which is <code>"pairwise"</code>.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hypothesis_test.html">hypothesis_test</a></span><span class="op">(</span><span class="va">m</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sepal.Length"</span>, <span class="st">"Species"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # Linear trend for Sepal.Length</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Species              | Contrast |        95% CI |      p</span></span>
<span><span class="co">#&gt; --------------------------------------------------------</span></span>
<span><span class="co">#&gt; setosa-versicolor    |     0.48 | [ 0.22, 0.74] | &lt; .001</span></span>
<span><span class="co">#&gt; setosa-virginica     |     0.57 | [ 0.32, 0.81] | &lt; .001</span></span>
<span><span class="co">#&gt; versicolor-virginica |     0.09 | [-0.10, 0.28] | 0.366</span></span></code></pre></div>
<p>The linear trend of <code>Sepal.Length</code> within
<code>setosa</code> is significantly different from the linear trend of
<code>versicolor</code> and also from <code>virginica</code>. The
difference of slopes between <code>virginica</code> and
<code>versicolor</code> is not statistically significant (p =
0.366).</p>
</div>
</div>
<div class="section level3">
<h3 id="is-the-difference-linear-trends-of-sepal-length-in-between-two-groups-of-species-significantly-different-from-the-difference-of-two-linear-trends-between-two-other-groups">Is the difference linear trends of <code>Sepal.Length</code> in
between two groups of <code>Species</code> significantly different from
the difference of two linear trends between two other groups?<a class="anchor" aria-label="anchor" href="#is-the-difference-linear-trends-of-sepal-length-in-between-two-groups-of-species-significantly-different-from-the-difference-of-two-linear-trends-between-two-other-groups"></a>
</h3>
<p>Similar to the example for categorical predictors, we can also test a
difference-in-differences for this example. For instance, is the
difference of the slopes from <code>Sepal.Length</code> between
<code>setosa</code> and <code>versicolor</code> different from the
slope-difference for the groups <code>setosa</code> and
<code>vigninica</code>?</p>
<p>This difference-in-differences we’re interested in is again indicated
by the purple arrow in the below plot.</p>
<p><img src="introduction_comparisons_files/figure-html/unnamed-chunk-27-1.png" width="672"></p>
<p>Let’s look at the different slopes separately first, i.e. the slopes
of <code>Sepal.Length</code> by levels of <code>Species</code>:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hypothesis_test.html">hypothesis_test</a></span><span class="op">(</span><span class="va">m</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sepal.Length"</span>, <span class="st">"Species"</span><span class="op">)</span>, test <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="co">#&gt; # Linear trend for Sepal.Length</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Species    | Slope |       95% CI |      p</span></span>
<span><span class="co">#&gt; ------------------------------------------</span></span>
<span><span class="co">#&gt; setosa     |  0.80 | [0.58, 1.01] | &lt; .001</span></span>
<span><span class="co">#&gt; versicolor |  0.32 | [0.17, 0.47] | &lt; .001</span></span>
<span><span class="co">#&gt; virginica  |  0.23 | [0.11, 0.35] | &lt; .001</span></span></code></pre></div>
<p>The first difference of slopes we’re interested in is the one between
<code>setosa</code> (0.8) and <code>versicolor</code> (0.32),
i.e. <code>b1 - b2</code> (=0.48). The second difference is between
levels <code>setosa</code> (0.8) and <code>virginica</code> (0.23),
which is <code>b1 - b3</code> (=0.57). We test the null hypothesis that
<code>(b1 - b2) = (b1 - b3)</code>.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hypothesis_test.html">hypothesis_test</a></span><span class="op">(</span><span class="va">m</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sepal.Length"</span>, <span class="st">"Species"</span><span class="op">)</span>, test <span class="op">=</span> <span class="st">"(b1 - b2) = (b1 - b3)"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Hypothesis      | Contrast |        95% CI |     p</span></span>
<span><span class="co">#&gt; --------------------------------------------------</span></span>
<span><span class="co">#&gt; (b1-b2)=(b1-b3) |    -0.09 | [-0.28, 0.10] | 0.366</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Tested hypothesis: (Species[setosa] - Species[versicolor]) = (Species[setosa] - Species[virginica])</span></span></code></pre></div>
<p>The difference between the two differences is (-0.09) and not
statistically significant (p = 0.366).</p>
</div>
<div class="section level3">
<h3 id="is-the-linear-trend-of-sepal-length-significant-at-different-values-of-another-numeric-predictor">Is the linear trend of <code>Sepal.Length</code> significant at
different values of another numeric predictor?<a class="anchor" aria-label="anchor" href="#is-the-linear-trend-of-sepal-length-significant-at-different-values-of-another-numeric-predictor"></a>
</h3>
<p>The last example is an interaction between two numeric predictors. In
case of interaction terms, adjusted predictions are usually shown at
representative values. If a <em>numeric</em> variable is specified as
second or third interaction term, representative values (see
<code><a href="../reference/values_at.html">values_at()</a></code>) are typically mean +/- SD.</p>
<p>In the next example, we have <code>Petal.Width</code> as second
interaction term, thus we see the predicted values of
<code>Sepal.Width</code> (our outcome) for <code>Petal.Length</code> at
three different, representative values of <code>Petal.Width</code>: Mean
(1.2), 1 SD above the mean (1.96) and 1 SD below the mean (0.44).</p>
<div class="section level4">
<h4 id="predictions-3">Predictions<a class="anchor" aria-label="anchor" href="#predictions-3"></a>
</h4>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Sepal.Width</span> <span class="op">~</span> <span class="va">Petal.Length</span> <span class="op">*</span> <span class="va">Petal.Width</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></span>
<span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggpredict.html">ggpredict</a></span><span class="op">(</span><span class="va">m</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Petal.Length"</span>, <span class="st">"Petal.Width"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">pred</span><span class="op">)</span></span></code></pre></div>
<p><img src="introduction_comparisons_files/figure-html/unnamed-chunk-32-1.png" width="672"></p>
<p>For <code><a href="../reference/hypothesis_test.html">hypothesis_test()</a></code>, these three values (mean, +1 SD
and -1 SD) work in the same way as if <code>Petal.Width</code> was a
categorical predictor with three levels.</p>
<p>First, we want to see at which value of <code>Petal.Width</code> the
slopes of <code>Petal.Length</code> are significant. We do no pairwise
comparison here, hence we set <code>test = NULL</code>.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hypothesis_test.html">hypothesis_test</a></span><span class="op">(</span><span class="va">pred</span>, test <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="co">#&gt; # Linear trend for Petal.Length</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Petal.Width | Slope |         95% CI |      p</span></span>
<span><span class="co">#&gt; ---------------------------------------------</span></span>
<span><span class="co">#&gt; 0.44        | -0.28 | [-0.39, -0.16] | &lt; .001</span></span>
<span><span class="co">#&gt; 1.20        | -0.11 | [-0.23,  0.01] | 0.073 </span></span>
<span><span class="co">#&gt; 1.96        |  0.06 | [-0.09,  0.20] | 0.436</span></span>
<span><span class="co"># same as:</span></span>
<span><span class="co"># hypothesis_test(m, c("Petal.Length", "Petal.Width"), test = NULL)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="pairwise-comparisons-4">Pairwise comparisons<a class="anchor" aria-label="anchor" href="#pairwise-comparisons-4"></a>
</h4>
<p>The results of the pairwise comparison are shown below. These tell us
that all linear trends (slopes) are significantly different from each
other, i.e. the slope of the green line is significantly different from
the slope of the red line, and so on.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hypothesis_test.html">hypothesis_test</a></span><span class="op">(</span><span class="va">pred</span><span class="op">)</span></span>
<span><span class="co">#&gt; # Linear trend for Petal.Length</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Petal.Width | Contrast |         95% CI |      p</span></span>
<span><span class="co">#&gt; ------------------------------------------------</span></span>
<span><span class="co">#&gt; 0.44-1.2    |    -0.17 | [-0.21, -0.12] | &lt; .001</span></span>
<span><span class="co">#&gt; 0.44-1.96   |    -0.33 | [-0.43, -0.24] | &lt; .001</span></span>
<span><span class="co">#&gt; 1.2-1.96    |    -0.17 | [-0.21, -0.12] | &lt; .001</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>Thanks to the great <em>marginaleffects</em> package, it is now
possible to have a powerful function in <em>ggeffects</em> that allows
to perform the next logical step after calculating adjusted predictions
and to conduct hypothesis tests for contrasts and pairwise
comparisons.</p>
<p>While the current implementation in <code><a href="../reference/hypothesis_test.html">hypothesis_test()</a></code>
already covers many common use cases for testing contrasts and pairwise
comparison, there still might be the need for more sophisticated
comparisons. In this case, I recommend using the <a href="https://vincentarelbundock.github.io/marginaleffects/" class="external-link"><em>marginaleffects</em></a>
package directly. Some further related recommended readings are the
vignettes about <a href="https://vincentarelbundock.github.io/marginaleffects/articles/comparisons.html" class="external-link">Comparisons</a>
or <a href="https://vincentarelbundock.github.io/marginaleffects/articles/hypothesis.html" class="external-link">Hypothesis
Tests, Equivalence Tests, and Custom Contrasts</a>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://github.com/strengejacke" class="external-link">Daniel Lüdecke</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
