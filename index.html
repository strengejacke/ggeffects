<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Create Tidy Data Frames of Marginal Effects for ggplot from Model Outputs • ggeffects</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/Roboto-0.4.9/font.css" rel="stylesheet">
<link href="deps/JetBrains_Mono-0.4.9/font.css" rel="stylesheet">
<link href="deps/Roboto_Slab-0.4.9/font.css" rel="stylesheet">
<link href="deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Create Tidy Data Frames of Marginal Effects for ggplot from Model Outputs">
<meta name="description" content="Compute marginal effects and adjusted predictions from statistical models and returns the result as tidy data frames. These data frames are ready to use with the ggplot2-package. Effects and predictions can be calculated for many different models. Interaction terms, splines and polynomial terms are also supported. The main functions are ggpredict(), ggemmeans() and ggeffect(). There is a generic plot()-method to plot the results using ggplot2.">
<meta property="og:description" content="Compute marginal effects and adjusted predictions from statistical models and returns the result as tidy data frames. These data frames are ready to use with the ggplot2-package. Effects and predictions can be calculated for many different models. Interaction terms, splines and polynomial terms are also supported. The main functions are ggpredict(), ggemmeans() and ggeffect(). There is a generic plot()-method to plot the results using ggplot2.">
<meta property="og:image" content="https://strengejacke.github.io/ggeffects/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">ggeffects</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.8.17</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="index.html"><span class="fa fa-home fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">News</a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-introductions" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Introductions</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-introductions">
<li><a class="dropdown-item" href="articles/ggeffects.html">Adjusted predictions of regression models</a></li>
    <li><a class="dropdown-item" href="articles/introduction_effectsatvalues.html">Adjusted predictions at specific values</a></li>
    <li><a class="dropdown-item" href="articles/introduction_randomeffects.html">Adjusted predictions for mixed models</a></li>
    <li><a class="dropdown-item" href="articles/practical_robustestimation.html">(Cluster) Robust standard errors</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-interpretation" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Interpretation</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-interpretation">
<li><a class="dropdown-item" href="articles/introduction_comparisons_1.html">Contrasts and pairwise comparisons</a></li>
    <li><a class="dropdown-item" href="articles/introduction_comparisons_2.html">Slopes, floodlight and spotlight analysis</a></li>
    <li><a class="dropdown-item" href="articles/introduction_comparisons_3.html">Contrasts and pairwise comparisons for GLM</a></li>
    <li><a class="dropdown-item" href="articles/introduction_comparisons_4.html">Contrasts and pairwise comparisons for Zero-Inflation Models</a></li>
    <li><a class="dropdown-item" href="articles/introduction_comparisons_5.html">Using marginaleffects or emmeans for comparisons</a></li>
    <li><a class="dropdown-item" href="articles/introduction_partial_residuals.html">Adding partial residuals to effects plots</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-plotting-and-printing" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Plotting and Printing</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-plotting-and-printing">
<li><a class="dropdown-item" href="articles/introduction_plotmethod.html">Plotting adjusted predictions</a></li>
    <li><a class="dropdown-item" href="articles/introduction_plotcustomize.html">Customize plot appearance</a></li>
    <li><a class="dropdown-item" href="articles/introduction_print.html">Customize table appearance</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-case-studies" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Case Studies</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-case-studies">
<li><a class="dropdown-item" href="articles/practical_glm_workflow.html">Simple workflow using logistic regression</a></li>
    <li><a class="dropdown-item" href="articles/practical_logisticmixedmodel.html">Logistic mixed effects Model with interaction term</a></li>
    <li><a class="dropdown-item" href="articles/practical_intersectionality.html">Intersectionality analysis using the MAIHDA framework</a></li>
    <li><a class="dropdown-item" href="articles/practical_marginaleffects_pkg.html">Comparison of ggeffects and marginaleffects</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-technical-details" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Technical Details</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-technical-details">
<li><a class="dropdown-item" href="articles/technical_get_predictions.html">Adding own class-methods to ggeffects</a></li>
    <li><a class="dropdown-item" href="articles/technical_differencepredictemmeans.html">Difference between marginalization methods</a></li>
    <li><a class="dropdown-item" href="articles/technical_stata.html">Different Output between Stata and ggeffects</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/strengejacke/ggeffects/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="ggeffects---estimated-marginal-means-and-adjusted-predictions-from-regression-models">ggeffects - Estimated Marginal Means and Adjusted Predictions from Regression Models<a class="anchor" aria-label="anchor" href="#ggeffects---estimated-marginal-means-and-adjusted-predictions-from-regression-models"></a>
</h1>
</div>
<p><a href="https://doi.org/10.21105/joss.00772" class="external-link"><img src="http://joss.theoj.org/papers/10.21105/joss.00772/status.svg" alt="DOI"></a> <a href="https://strengejacke.github.io/ggeffects/"><img src="https://img.shields.io/badge/documentation-ggeffects-orange.svg?colorB=E91E63" alt="Documentation"></a> <a href="https://cranlogs.r-pkg.org/" class="external-link"><img src="http://cranlogs.r-pkg.org/badges/ggeffects" alt="downloads"></a> <a href="https://cranlogs.r-pkg.org/" class="external-link"><img src="http://cranlogs.r-pkg.org/badges/grand-total/ggeffects" alt="total"></a></p>
<p>Lüdecke D (2018). <em>ggeffects: Tidy Data Frames of Marginal Effects from Regression Models.</em> Journal of Open Source Software, 3(26), 772. doi: <a href="https://doi.org/10.21105/joss.00772" class="external-link">10.21105/joss.00772</a></p>
<div class="section level2">
<h2 id="why-do-we-need-marginalconditional-effects-or-adjusted-predicted-values">Why do we need (marginal/conditional) effects or (adjusted) predicted values?<a class="anchor" aria-label="anchor" href="#why-do-we-need-marginalconditional-effects-or-adjusted-predicted-values"></a>
</h2>
<p>After fitting a model, it is useful generate model-based estimates (expected values, or <em>adjusted predictions</em>) of the response variable for different combinations of predictor values. Such estimates can be used to make inferences about relationships between variables - adjusted predictions tell you: what is the expected ouctome for certain values or levels of my predictors?</p>
<p><em>Adjusted predictions</em> or <em>marginal means</em> are often easier to understand than raw regression coefficients. In particular, their visualization allows to intuitively get the idea of how predictors and outcome are associated, even for complex models.</p>
</div>
<div class="section level2">
<h2 id="aims-of-this-package">Aims of this package<a class="anchor" aria-label="anchor" href="#aims-of-this-package"></a>
</h2>
<p><strong>ggeffects</strong> is a light-weight package that aims at easily calculating adjusted predictions and estimated marginal means at meaningful values of covariates from statistical models. Furthermore, it is possible to compute contrasts or pairwise comparisons, to test predictions and differences in predictions for statistical significance. Finally, you can easily produce nice figures to visualize the results.</p>
<p>What you basically would need for your workflow is:</p>
<ul>
<li>
<code><a href="reference/predict_response.html">predict_response()</a></code> (understand your results)</li>
<li>
<code><a href="reference/test_predictions.html">test_predictions()</a></code> (check for “significant” results)</li>
<li>
<code><a href="reference/plot.html">plot()</a></code> (communicate your results)</li>
</ul>
<p>Three core ideas describe the philosophy of the function design and help users to achieve the above mentioned goals:</p>
<ol style="list-style-type: decimal">
<li><p>Functions are type-safe and always return a data frame with the same, consistent structure;</p></li>
<li><p>there is a simple, unique approach to calculate adjusted predictions and estimated marginal means for many different models;</p></li>
<li><p>the package supports “labelled data” (Lüdecke 2018), which allows human readable annotations for graphical outputs.</p></li>
</ol>
<p>This means, users do not need to care about any expensive steps after modeling to visualize the results. The returned as data frame is ready to use with the <strong>ggplot2</strong>-package, however, there is also a <code><a href="reference/plot.html">plot()</a></code>-method to easily create publication-ready figures.</p>
<p>Adjusted predictions or estimated marginal means are always calculated on the <em>response</em> scale, which is the easiest and most intuitive scale to interpret the results.</p>
<p>It is easy to start, you just need one function: <code><a href="reference/predict_response.html">predict_response()</a></code>, and two arguments: the model and the “focal terms”, i.e. the predictors that you are mainly interested in. Examples are shown below.</p>
</div>
<div class="section level2">
<h2 id="so-when-do-i-need-the-ggeffects-package">So, when do I need the <em>ggeffects</em> package?<a class="anchor" aria-label="anchor" href="#so-when-do-i-need-the-ggeffects-package"></a>
</h2>
<p>You should use <em>ggeffects</em>…</p>
<ul>
<li><p>… when you want to understand how predictors and outcome are related, no matter whether you have simple or complex models, interaction or transformed terms. See how to start <a href="https://strengejacke.github.io/ggeffects/articles/ggeffects.html">in this vignette</a>. The syntax for the <em>ggeffects</em> functions is super easy and consistent across the different type of models and complexity.</p></li>
<li><p>… when you want to perform pairwise comparisons, in order to see whether there are statistically significant differences in the association of, for instance, different groups or categories of your predictors and your outcome (“effects”, or sometimes “marginal effects”). There are several vignettes describing this in detail, starting <a href="https://strengejacke.github.io/ggeffects/articles/introduction_comparisons_1.html">with this vignette</a>.</p></li>
<li><p>… when you need impressive figures instead of long, confusing tables to describe your results. There are several examples in the <a href="https://strengejacke.github.io/ggeffects/">documentation</a>, for example <a href="https://strengejacke.github.io/ggeffects/articles/introduction_plotmethod.html">this vignette</a>.</p></li>
<li><p>… and even when you want to check, whether your model appropriately describes your data. See <a href="https://strengejacke.github.io/ggeffects/articles/introduction_partial_residuals.html">this vignette</a> to learn more about how to use <em>ggeffects</em> for model diagnostics.</p></li>
</ul>
<p>A workflow in R would then include using following functions in this order: <code><a href="reference/predict_response.html">predict_response()</a></code>, <code><a href="reference/plot.html">plot()</a></code>, and <code><a href="reference/test_predictions.html">test_predictions()</a></code> - that’s all you need! See also <a href="https://strengejacke.github.io/ggeffects/articles/practical_glm_workflow.html">this example workflow</a> using logistic regression.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p><a href="https://cran.r-project.org/package=ggeffects" class="external-link"><img src="https://www.r-pkg.org/badges/version/ggeffects" alt="CRAN"></a> <a href="https://strengejacke.r-universe.dev" class="external-link"><img src="https://strengejacke.r-universe.dev/badges/ggeffects" alt="parameters status badge"></a></p>
<table class="table">
<colgroup>
<col width="33%">
<col width="33%">
<col width="33%">
</colgroup>
<thead><tr>
<th>Type</th>
<th>Source</th>
<th>Command</th>
</tr></thead>
<tbody>
<tr>
<td>Release</td>
<td>CRAN</td>
<td><code>install.packages("ggeffects")</code></td>
</tr>
<tr>
<td>Development</td>
<td>r - universe</td>
<td><code>install.packages("ggeffects", repos = "https://strengejacke.r-universe.dev")</code></td>
</tr>
<tr>
<td>Development</td>
<td>GitHub</td>
<td><code>remotes::install_github("strengejacke/ggeffects")</code></td>
</tr>
</tbody>
</table>
<p>Or you can run <a href="https://strengejacke.github.io/ggeffects/reference/install_latest.html"><code>ggeffects::install_latest()</code></a> to install the latest development version from r-universe.</p>
</div>
<div class="section level2">
<h2 id="adjusted-predictions-at-marginalizing-over-non-focal-predictors">Adjusted predictions at…: marginalizing over non-focal predictors<a class="anchor" aria-label="anchor" href="#adjusted-predictions-at-marginalizing-over-non-focal-predictors"></a>
</h2>
<p><code><a href="reference/predict_response.html">predict_response()</a></code> is a wrapper around three “workhorse” functions, <code><a href="reference/ggpredict.html">ggpredict()</a></code>, <code><a href="reference/ggpredict.html">ggemmeans()</a></code> and <code><a href="reference/ggpredict.html">ggaverage()</a></code>. Depending on the value of the <code>margin</code> argument, <code><a href="reference/predict_response.html">predict_response()</a></code> calls one of those functions, with different arguments. It’s important to note that:</p>
<ol style="list-style-type: decimal">
<li><p>Predictions are always returned on the <em>response scale</em>, no matter which model is used. This is the most intuitive scale to interpret your results (the predicted values).</p></li>
<li><p>The response is predicted at the values or levels of your <em>focal terms</em>, i.e. you specify the predictors you are mainly interested in, using the <code>terms</code> argument. The predicted values are calculated for these values, while all other predictors are marginalized over.</p></li>
</ol>
<p>The <code>margin</code> argument in <code><a href="reference/predict_response.html">predict_response()</a></code> indicates how to marginalize over the <em>non-focal</em> predictors, i.e. those variables that are <em>not</em> specified in <code>terms</code>. Each option answers slightly different questions. Possible values are:</p>
<ul>
<li>
<p><code>"mean_reference"</code> and <code>"mean_mode"</code>: <code>"mean_reference"</code> calls <code><a href="reference/ggpredict.html">ggpredict()</a></code>, i.e. non-focal predictors are set to their mean (numeric variables), reference level (factors), or “most common” value (mode) in case of character vectors. <code>"mean_mode"</code> calls <code>ggpredict(typical = c(numeric = "mean", factor = "mode"))</code>, i.e. non-focal predictors are set to their mean (numeric variables) or mode (factors, or “most common” value in case of character vectors).</p>
<p>Question answered: “What is the predicted (or: expected) value of the response at meaningful values or levels of my focal terms for a ‘typical’ observation in my data?”, where ‘typical’ refers to certain characteristics of the remaining predictors.</p>
</li>
<li>
<p><code>"marginalmeans"</code>: calls <code><a href="reference/ggpredict.html">ggemmeans()</a></code>, i.e. non-focal predictors are set to their mean (numeric variables) or marginalized over the levels or “values” for factors and character vectors. Marginalizing over the factor levels of non-focal terms computes a kind of “weighted average” for the values at which these terms are hold constant. There are different weighting options that can be chosen with the <code>weights</code> argument.</p>
<p>Question answered: “What is the predicted (or: expected) value of the response at meaningful values or levels of my focal terms for an ‘average’ observation in my data?”. It refers to randomly picking a subject of your sample and the result you get on average.</p>
</li>
<li>
<p><code>"empirical"</code> (or on of its aliases, <code>"counterfactual"</code> or <code>"average"</code>): calls <code><a href="reference/ggpredict.html">ggaverage()</a></code>, i.e. non-focal predictors are marginalized over the observations in your sample. The response is predicted for each subject in the data and predicted values are then averaged across all subjects, aggregated/grouped by the focal terms. Averaging is applied to “counterfactual” predictions (Dickerman and Hernán 2020). There is a more detailed description in <a href="https://strengejacke.github.io/ggeffects/articles/technical_differencepredictemmeans.html">this vignette</a>.</p>
<p>Question answered: “What is the predicted (or: expected) value of the response at meaningful values or levels of my focal terms for the ‘average’ observation in the population?”. It does not only refer to the actual data in your sample, but also “what would be if” we had more data, or if we had data from a different population.</p>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="documentation-and-support">Documentation and Support<a class="anchor" aria-label="anchor" href="#documentation-and-support"></a>
</h2>
<p>Please visit <a href="https://strengejacke.github.io/ggeffects/" class="uri">https://strengejacke.github.io/ggeffects/</a> for documentation and vignettes. For questions about the functionality, you may either contact me via email or also file an issue.</p>
</div>
<div class="section level2">
<h2 id="ggeffects-supports-many-different-models-and-is-easy-to-use">ggeffects supports many different models and is easy to use<a class="anchor" aria-label="anchor" href="#ggeffects-supports-many-different-models-and-is-easy-to-use"></a>
</h2>
<p>Adjusted predictions can be calculated for many different models. Currently supported model-objects are: averaging, bamlss, bayesglm, bayesx, betabin, betareg, bglmer, bigglm, biglm, blmer, bracl, brglm, brmsfit, brmultinom, cgam, cgamm, clm, clm2, clmm, coxph, feglm, fixest, flac, flic, gam, Gam, gamlss, gamm, gamm4, gee, geeglm, glimML, glm, glm.nb, glm_weightit, glmer.nb, glmerMod, glmgee, glmmPQL, glmmTMB, glmrob, glmRob, glmx, gls, hurdle, ivreg, lm, lm_robust, lme, lmerMod, lmrob, lmRob, logistf, logitr, lrm, mblogit, mclogit, MCMCglmm, merMod, merModLmerTest, MixMod, mixor, mlogit, multinom, multinom_weightit, negbin, nestedLogit, nlmerMod, ols, ordinal_weightit, orm, phyloglm, phylolm, plm, polr, rlm, rlmerMod, rq, rqs, rqss, sdmTMB, speedglm, speedlm, stanreg, survreg, svyglm, svyglm.nb, tidymodels, tobit, truncreg, vgam, vglm, wblm, wbm, Zelig-relogit, zeroinfl, zerotrunc.</p>
<p>Support for models varies by marginalization method (the <code>margin</code> argument), i.e. although <code><a href="reference/predict_response.html">predict_response()</a></code> supports most models, some models are only supported exclusively by one of the four downstream functions (<code><a href="reference/ggpredict.html">ggpredict()</a></code>, <code><a href="reference/ggpredict.html">ggemmeans()</a></code>, <code><a href="reference/ggpredict.html">ggeffect()</a></code> or <code><a href="reference/ggpredict.html">ggaverage()</a></code>). This means that not all models work for every <code>margin</code> option of <code><a href="reference/predict_response.html">predict_response()</a></code>. Other models not listed here might work as well, but are currently not tested.</p>
<p>Interaction terms, splines and polynomial terms are also supported. There is a generic <code><a href="reference/plot.html">plot()</a></code>-method to plot the results using <strong>ggplot2</strong>.</p>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<p>The returned data frames always have the same, consistent structure and column names, so it’s easy to create ggplot-plots without the need to re-write the function call. <code>x</code> and <code>predicted</code> are the values for the x- and y-axis. <code>conf.low</code> and <code>conf.high</code> could be used as <code>ymin</code> and <code>ymax</code> aesthetics for ribbons to add confidence bands to the plot. <code>group</code> can be used as grouping-aesthetics, or for faceting.</p>
<p><code><a href="reference/predict_response.html">predict_response()</a></code> requires at least one, but not more than four terms specified in the <code>terms</code>-argument. Predicted values of the response, along the values of the first term are calculated, optionally grouped by the other terms specified in <code>terms</code>.</p>
<div class="section level3">
<h3 id="adjusted-predictions-for-one-focal-predictor">Adjusted predictions for one focal predictor<a class="anchor" aria-label="anchor" href="#adjusted-predictions-for-one-focal-predictor"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://strengejacke.github.io/ggeffects/">ggeffects</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">splines</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/datawizard/" class="external-link">datawizard</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">efc</span>, package <span class="op">=</span> <span class="st">"ggeffects"</span><span class="op">)</span></span>
<span><span class="va">efc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://easystats.github.io/datawizard/reference/to_factor.html" class="external-link">to_factor</a></span><span class="op">(</span><span class="va">efc</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"c161sex"</span>, <span class="st">"e42dep"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">barthtot</span> <span class="op">~</span> <span class="va">c12hour</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/splines/bs.html" class="external-link">bs</a></span><span class="op">(</span><span class="va">neg_c_7</span><span class="op">)</span> <span class="op">*</span> <span class="va">c161sex</span> <span class="op">+</span> <span class="va">e42dep</span>, data <span class="op">=</span> <span class="va">efc</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/predict_response.html">predict_response</a></span><span class="op">(</span><span class="va">fit</span>, terms <span class="op">=</span> <span class="st">"c12hour"</span><span class="op">)</span></span>
<span><span class="co">#&gt; # Predicted values of barthtot</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; c12hour | Predicted |       95% CI</span></span>
<span><span class="co">#&gt; ----------------------------------</span></span>
<span><span class="co">#&gt;       4 |     89.91 | 84.18, 95.63</span></span>
<span><span class="co">#&gt;      12 |     89.34 | 83.62, 95.06</span></span>
<span><span class="co">#&gt;      22 |     88.63 | 82.90, 94.36</span></span>
<span><span class="co">#&gt;      36 |     87.64 | 81.88, 93.40</span></span>
<span><span class="co">#&gt;      49 |     86.72 | 80.90, 92.53</span></span>
<span><span class="co">#&gt;      70 |     85.23 | 79.30, 91.16</span></span>
<span><span class="co">#&gt;     100 |     83.10 | 76.92, 89.29</span></span>
<span><span class="co">#&gt;     168 |     78.28 | 71.24, 85.33</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Adjusted for:</span></span>
<span><span class="co">#&gt; * neg_c_7 =       11.83</span></span>
<span><span class="co">#&gt; * c161sex =        Male</span></span>
<span><span class="co">#&gt; *  e42dep = independent</span></span></code></pre></div>
<p>A possible call to ggplot could look like this:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="va">mydf</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/predict_response.html">predict_response</a></span><span class="op">(</span><span class="va">fit</span>, terms <span class="op">=</span> <span class="st">"c12hour"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mydf</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">predicted</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">conf.low</span>, ymax <span class="op">=</span> <span class="va">conf.high</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-3-1.png"><!-- --></p>
<p>However, there is also a <code><a href="reference/plot.html">plot()</a></code>-method. This method uses convenient defaults, to easily create the most suitable plot for the predictions.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mydf</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/predict_response.html">predict_response</a></span><span class="op">(</span><span class="va">fit</span>, terms <span class="op">=</span> <span class="st">"c12hour"</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mydf</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-4-1.png"><!-- --></p>
</div>
<div class="section level3">
<h3 id="adjusted-predictions-for-several-focal-predictors">Adjusted predictions for several focal predictors<a class="anchor" aria-label="anchor" href="#adjusted-predictions-for-several-focal-predictors"></a>
</h3>
<p>With three variables, predictions can be grouped and faceted.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/predict_response.html">predict_response</a></span><span class="op">(</span><span class="va">fit</span>, terms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"neg_c_7"</span>, <span class="st">"c161sex"</span>, <span class="st">"e42dep"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># we want a more compact table, thus we use `print()` explicitly</span></span>
<span><span class="fu"><a href="reference/print.html">print</a></span><span class="op">(</span><span class="va">result</span>, collapse_table <span class="op">=</span> <span class="cn">TRUE</span>, collapse_ci <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; # Predicted values of barthtot</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; neg_c_7 | c161sex |               e42dep |     Predicted (95% CI)</span></span>
<span><span class="co">#&gt; -----------------------------------------------------------------</span></span>
<span><span class="co">#&gt;       7 |    Male |          independent |  93.73 (87.01, 100.44)</span></span>
<span><span class="co">#&gt;      12 |         |                      |  86.89 (81.09,  92.70)</span></span>
<span><span class="co">#&gt;      17 |         |                      |  80.62 (73.69,  87.54)</span></span>
<span><span class="co">#&gt;      28 |         |                      | 148.54 (85.66, 211.42)</span></span>
<span><span class="co">#&gt;       7 |         |   slightly dependent |  87.41 (81.27,  93.56)</span></span>
<span><span class="co">#&gt;      12 |         |                      |  80.58 (76.32,  84.84)</span></span>
<span><span class="co">#&gt;      17 |         |                      |  74.31 (68.46,  80.15)</span></span>
<span><span class="co">#&gt;      28 |         |                      | 142.23 (79.71, 204.75)</span></span>
<span><span class="co">#&gt;       7 |         | moderately dependent |  78.29 (72.08,  84.49)</span></span>
<span><span class="co">#&gt;      12 |         |                      |  71.46 (67.64,  75.27)</span></span>
<span><span class="co">#&gt;      17 |         |                      |  65.18 (59.75,  70.60)</span></span>
<span><span class="co">#&gt;      28 |         |                      | 133.10 (70.44, 195.76)</span></span>
<span><span class="co">#&gt;       7 |         |   severely dependent |  41.93 (35.66,  48.21)</span></span>
<span><span class="co">#&gt;      12 |         |                      |  35.10 (30.98,  39.22)</span></span>
<span><span class="co">#&gt;      17 |         |                      |  28.82 (23.41,  34.24)</span></span>
<span><span class="co">#&gt;      28 |         |                      |  96.75 (34.08, 159.41)</span></span>
<span><span class="co">#&gt;       7 |  Female |          independent |  98.04 (93.06, 103.02)</span></span>
<span><span class="co">#&gt;      12 |         |                      |  86.61 (81.85,  91.37)</span></span>
<span><span class="co">#&gt;      17 |         |                      |  82.58 (77.33,  87.82)</span></span>
<span><span class="co">#&gt;      28 |         |                      |  81.57 (64.41,  98.73)</span></span>
<span><span class="co">#&gt;       7 |         |   slightly dependent |  91.73 (87.89,  95.57)</span></span>
<span><span class="co">#&gt;      12 |         |                      |  80.30 (77.43,  83.17)</span></span>
<span><span class="co">#&gt;      17 |         |                      |  76.26 (72.57,  79.96)</span></span>
<span><span class="co">#&gt;      28 |         |                      |  75.26 (58.64,  91.87)</span></span>
<span><span class="co">#&gt;       7 |         | moderately dependent |  82.60 (78.62,  86.59)</span></span>
<span><span class="co">#&gt;      12 |         |                      |  71.17 (68.79,  73.56)</span></span>
<span><span class="co">#&gt;      17 |         |                      |  67.14 (63.95,  70.33)</span></span>
<span><span class="co">#&gt;      28 |         |                      |  66.13 (49.52,  82.74)</span></span>
<span><span class="co">#&gt;       7 |         |   severely dependent |  46.25 (41.93,  50.57)</span></span>
<span><span class="co">#&gt;      12 |         |                      |  34.82 (32.27,  37.37)</span></span>
<span><span class="co">#&gt;      17 |         |                      |  30.78 (27.67,  33.90)</span></span>
<span><span class="co">#&gt;      28 |         |                      |  29.78 (13.33,  46.23)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Adjusted for:</span></span>
<span><span class="co">#&gt; * c12hour = 42.10</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">result</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">predicted</span>, colour <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">facet</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-5-1.png"><!-- --></p>
<p><code><a href="reference/plot.html">plot()</a></code> works for this case, as well:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/plot.html">plot</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-6-1.png"><!-- --></p>
</div>
<div class="section level3">
<h3 id="contrasts-and-pairwise-comparisons">Contrasts and pairwise comparisons<a class="anchor" aria-label="anchor" href="#contrasts-and-pairwise-comparisons"></a>
</h3>
<p>Next, an example of an interaction term. We want to know whether the two slopes are significantly different from each other.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">neg_c_7</span> <span class="op">~</span> <span class="va">c12hour</span> <span class="op">+</span> <span class="va">barthtot</span> <span class="op">*</span> <span class="va">c161sex</span> <span class="op">+</span> <span class="va">e42dep</span>, data <span class="op">=</span> <span class="va">efc</span><span class="op">)</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/predict_response.html">predict_response</a></span><span class="op">(</span><span class="va">fit</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"barthtot"</span>, <span class="st">"c161sex"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/plot.html">plot</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-7-1.png"><!-- --></p>
<p>This can be achieved by <code><a href="reference/test_predictions.html">test_predictions()</a></code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/test_predictions.html">test_predictions</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="co">#&gt; # (Average) Linear trend for barthtot</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; c161sex     | Contrast |      95% CI |     p</span></span>
<span><span class="co">#&gt; --------------------------------------------</span></span>
<span><span class="co">#&gt; Male-Female |     0.01 | -0.01, 0.03 | 0.466</span></span></code></pre></div>
<p>We can conclude that slopes (or “linear trends”) of <code>barthtot</code> for the different groups of <code>c161sex</code> are not statistically significantly different from each other.</p>
<p>More features are explained in detail in the <a href="https://strengejacke.github.io/ggeffects/">package-vignettes</a>.</p>
</div>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>In case you want / have to cite my package, please use <code>citation('ggeffects')</code> for citation information:</p>
<p>Lüdecke D (2018). <em>ggeffects: Tidy Data Frames of Marginal Effects from Regression Models.</em> Journal of Open Source Software, 3(26), 772. doi: <a href="https://doi.org/10.21105/joss.00772" class="external-link">10.21105/joss.00772</a></p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-dickerman_counterfactual_2020" class="csl-entry">
Dickerman, Barbra A., and Miguel A. Hernán. 2020. “Counterfactual Prediction Is Not Only for Causal Inference.” <em>European Journal of Epidemiology</em> 35 (7): 615–17. <a href="https://link.springer.com/article/10.1007/s10654-020-00659-8" class="external-link uri">https://link.springer.com/article/10.1007/s10654-020-00659-8</a>.
</div>
<div id="ref-daniel_ludecke_2018_1249216" class="csl-entry">
Lüdecke, Daniel. 2018. “Sjlabelled: Labelled Data Utility Functions,” May. <a href="https://doi.org/10.5281/zenodo.1249215" class="external-link uri">https://doi.org/10.5281/zenodo.1249215</a>.
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=ggeffects" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/strengejacke/ggeffects/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/strengejacke/ggeffects/issues/" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing ggeffects</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://github.com/strengejacke" class="external-link">Daniel Lüdecke</a> <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-8895-3206" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/strengejacke" class="external-link">Daniel Lüdecke</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>
